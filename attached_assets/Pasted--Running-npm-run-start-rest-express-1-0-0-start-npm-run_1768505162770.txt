==> Running 'npm run start'
> rest-express@1.0.0 start
> npm run db:push && node dist/index.js
> rest-express@1.0.0 db:push
> drizzle-kit push
No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/render/project/src/drizzle.config.ts'
Using 'pg' driver for database querying
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[✓] Pulling schema from database...
Is plain_password column in users table created or renamed from another column?
❯ + plain_password                    create column
  ~ kyc_document_url › plain_password rename column[2026-01-15 19:14:38] DEBUG Creating transport: nodemailer (7.0.12; +https://nodemailer.com/; SMTP (pool)/7.0.12[client:7.0.12])
7:14:38 PM [express] serving on port 10000
file:///opt/render/project/src/dist/index.js:71
`);Qa.write(UT.format.apply(UT,e))}}Object.defineProperty(ki.exports,"isWin",{get:function(){return vl},set:function(i){vl=i}});ki.exports.warnTo=function(i){var e=Qa;return Qa=i,e};ki.exports.getFileName=function(i){var e=i||process.env,t=e.PGPASSFILE||(vl?FT.join(e.APPDATA||"./","postgresql","pgpass.conf"):FT.join(e.HOME||"./",".pgpass"));return t};ki.exports.usePgPass=function(i,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:vl?!0:(e=e||"<unkn>",Az(i.mode)?i.mode&(Ez|kz)?(mm('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(mm('WARNING: password file "%s" is not a plain file',e),!1))};var Nz=ki.exports.match=function(i,e){return as.slice(0,-1).reduce(function(t,r,n){return n==1&&Number(i[r]||Sz)===Number(e[r])?t&&!0:t&&(e[r]==="*"||e[r]===i[r])},!0)};ki.exports.getPassword=function(i,e,t){var r,n=e.pipe(_z());function s(c){var l=Oz(c);l&&Iz(l)&&Nz(i,l)&&(r=l[Pz],n.end())}var a=function(){e.destroy(),t(r)},o=function(c){e.destroy(),mm("WARNING: error on reading file: %s",c),t(void 0)};e.on("error",o),n.on("data",s).on("end",a).on("error",o)};var Oz=ki.exports.parseLine=function(i){if(i.length<11||i.match(/^\s+#/))return null;for(var e="",t="",r=0,n=0,s=0,a={},o=!1,c=function(p,u,d){var f=i.substring(u,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(f=f.replace(/\\([:\\])/g,"$1")),a[as[p]]=f},l=0;l<i.length-1;l+=1){if(e=i.charAt(l+1),t=i.charAt(l),o=r==fm-1,o){c(r,n);break}l>=0&&e==":"&&t!=="\\"&&(c(r,n,l+1),n=l+2,r+=1)}return a=Object.keys(a).length===fm?a:null,a},Iz=ki.exports.isValidEntry=function(i){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<as.length;t+=1){var r=e[t],n=i[as[t]]||"",s=r(n);if(!s)return!1}return!0}});var QT=g((rK,hm)=>{"use strict";var iK=b("path"),HT=b("fs"),xl=$T();hm.exports=function(i,e){var t=xl.getFileName();HT.stat(t,function(r,n){if(r||!xl.usePgPass(n,t))return e(void 0);var s=HT.createReadStream(t);xl.getPassword(i,s,e)})};hm.exports.warnTo=xl.warnTo});var KT=g((nK,WT)=>{"use strict";var jz=b("events").EventEmitter,VT=ts(),gm=dT(),qz=pl(),Mz=Df(),GT=kT(),Rz=$a(),Lz=dm(),Dz=Mf(),yl=class extends jz{constructor(e){super(),this.connectionParameters=new Mz(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let t=e||{};this._Promise=t.Promise||global.Promise,this._types=new qz(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new Lz({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||Rz.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=r=>{process.nextTick(()=>{r.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){let t=this,r=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{r._ending=!0,r.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){t.ssl?r.requestSsl():r.startup(t.getStartupConf())}),r.on("sslconnect",function(){r.startup(t.getStartupConf())}),this._attachListeners(r),r.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,r)=>{this._connect(n=>{n?r(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(r=>{if(r!==void 0){if(typeof r!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=r}else this.connectionParameters.password=this.password=null;e()}).catch(r=>{t.emit("error",r)});else if(this.password!==null)e();else try{QT()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(r){this.emit("error",r)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await Dz.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=gm.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await gm.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{gm.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;return r&&(t.application_name=r),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){let r=this.connection;this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){r.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,r){return this._types.setTypeParser(e,t,r)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return VT.escapeIdentifier(e)}escapeLiteral(e){return VT.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,r){let n,s,a,o,c;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(a=e.query_timeout||this.connectionParameters.query_timeout,n=new GT(e,t,r),n.callback||(s=new this._Promise((l,p)=>{n.callback=(u,d)=>u?p(u):l(d)}).catch(l=>{throw Error.captureStackTrace(l),l}))),a&&(c=n.callback,o=setTimeout(()=>{let l=new Error("Query read timeout");process.nextTick(()=>{n.handleError(l,this.connection)}),c(l),n.callback=()=>{};let p=this.queryQueue.indexOf(n);p>-1&&this.queryQueue.splice(p,1),this._pulseQueryQueue()},a),n.callback=(l,p)=>{clearTimeout(o),c(l,p)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(n),this._pulseQueryQueue(),s):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};yl.Query=GT;WT.exports=yl});var YT=g((sK,JT)=>{"use strict";var Bz=b("events").EventEmitter,ZT=function(){},XT=(i,e)=>{let t=i.findIndex(e);return t===-1?void 0:i.splice(t,1)[0]},vm=class{constructor(e,t,r){this.client=e,this.idleListener=t,this.timeoutId=r}},os=class{constructor(e){this.callback=e}};function zz(){throw new Error("Release called on client which has already been released to the pool.")}function bl(i,e){if(e)return{callback:e,result:void 0};let t,r,n=function(a,o){a?t(a):r(o)},s=new i(function(a,o){r=a,t=o}).catch(a=>{throw Error.captureStackTrace(a),a});return{callback:n,result:s}}function Fz(i,e){return function t(r){r.client=e,e.removeListener("error",t),e.on("error",()=>{i.log("additional client error after disconnection due to error",r)}),i._remove(e),i.emit("error",r,e)}}var xm=class extends Bz{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||wl().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let r=t.client;r.ref&&r.ref();let n=t.idleListener;return this._acquireClient(r,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,t){let r=XT(this._idle,s=>s.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(s=>s!==e);let n=this;e.end(()=>{n.emit("remove",e),typeof t=="function"&&t()})}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=bl(this.Promise,e),r=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new os(t.callback)),r;let n=(o,c,l)=>{clearTimeout(a),t.callback(o,c,l)},s=new os(n),a=setTimeout(()=>{XT(this._pendingQueue,o=>o.callback===n),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return a.unref&&a.unref(),this._pendingQueue.push(s),r}return this.newClient(new os(t.callback)),r}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let r=Fz(this,t);this.log("checking client timeout");let n,s=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(n&&clearTimeout(n),t.on("error",r),a)this.log("client failed to connect",a),this._clients=this._clients.filter(o=>o!==t),s&&(a=new Error("Connection terminated due to connection timeout",{cause:a})),this._pulseQueue(),e.timedOut||e.callback(a,void 0,ZT);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(l=>l.client===t)!==-1&&this._acquireClient(t,new os((l,p,u)=>u()),r,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),t.once("end",()=>clearTimeout(o))}return this._acquireClient(t,e,r,!0)}})}_acquireClient(e,t,r,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,r),e.removeListener("error",r),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,ZT);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let r=!1;return n=>{r&&zz(),r=!0,this._release(e,t,n)}}_release(e,t,r){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",r,e),r||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let s;this.options.idleTimeoutMillis&&this._isAboveMin()&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new vm(e,t,s)),this._pulseQueue()}query(e,t,r){if(typeof e=="function"){let s=bl(this.Promise,e);return setImmediate(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(r=t,t=void 0);let n=bl(this.Promise,r);return r=n.callback,this.connect((s,a)=>{if(s)return r(s);let o=!1,c=l=>{o||(o=!0,a.release(l),r(l))};a.once("error",c),this.log("dispatching query");try{a.query(e,t,(l,p)=>{if(this.log("query dispatched"),a.removeListener("error",c),!o)return o=!0,a.release(l),l?r(l):r(void 0,p)})}catch(l){return a.release(l),r(l)}}),n.result}end(e){if(this.log("ending"),this.ending){let r=new Error("Called end on pool more than once");return e?e(r):this.Promise.reject(r)}this.ending=!0;let t=bl(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};JT.exports=xm});var i2=g((aK,t2)=>{"use strict";var e2=b("events").EventEmitter,Uz=b("util"),ym=ts(),cs=t2.exports=function(i,e,t){e2.call(this),i=ym.normalizeQueryConfig(i,e,t),this.text=i.text,this.values=i.values,this.name=i.name,this.queryMode=i.queryMode,this.callback=i.callback,this.state="new",this._arrayMode=i.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(r){r==="row"&&(this._emitRowEvents=!0)}.bind(this))};Uz.inherits(cs,e2);var $z={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};cs.prototype.handleError=function(i){let e=this.native.pq.resultErrorFields();if(e)for(let t in e){let r=$z[t]||t;i[r]=e[t]}this.callback?this.callback(i):this.emit("error",i),this.state="error"};cs.prototype.then=function(i,e){return this._getPromise().then(i,e)};cs.prototype.catch=function(i){return this._getPromise().catch(i)};cs.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(i,e){this._once("end",i),this._once("error",e)}.bind(this)),this._promise)};cs.prototype.submit=function(i){this.state="running";let e=this;this.native=i.native,i.native.arrayMode=this._arrayMode;let t=function(r,n,s){if(i.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),r)return e.handleError(r);e._emitRowEvents&&(s.length>1?n.forEach((a,o)=>{a.forEach(c=>{e.emit("row",c,s[o])})}):n.forEach(function(a){e.emit("row",a,s)})),e.state="end",e.emit("end",s),e.callback&&e.callback(null,s)};if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let r=(this.values||[]).map(ym.prepareValue);if(i.namedQueries[this.name]){if(this.text&&i.namedQueries[this.name]!==this.text){let n=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(n)}return i.native.execute(this.name,r,t)}return i.native.prepare(this.name,this.text,r.length,function(n){return n?t(n):(i.namedQueries[e.name]=e.text,e.native.execute(e.name,r,t))})}else if(this.values){if(!Array.isArray(this.values)){let n=new Error("Query values must be an array");return t(n)}let r=this.values.map(ym.prepareValue);i.native.query(this.text,r,t)}else this.queryMode==="extended"?i.native.query(this.text,[],t):i.native.query(this.text,t)}});var o2=g((oK,a2)=>{"use strict";var r2;try{r2=b("pg-native")}catch(i){throw i}var Hz=pl(),n2=b("events").EventEmitter,Qz=b("util"),Vz=Df(),s2=i2(),xt=a2.exports=function(i){n2.call(this),i=i||{},this._Promise=i.Promise||global.Promise,this._types=new Hz(i.types),this.native=new r2({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new Vz(i);i.nativeConnectionString&&(e.nativeConnectionString=i.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};xt.Query=s2;Qz.inherits(xt,n2);xt.prototype._errorAllQueries=function(i){let e=t=>{process.nextTick(()=>{t.native=this.native,t.handleError(i)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};xt.prototype._connect=function(i){let e=this;if(this._connecting){process.nextTick(()=>i(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,r){if(e.connectionParameters.nativeConnectionString&&(r=e.connectionParameters.nativeConnectionString),t)return i(t);e.native.connect(r,function(n){if(n)return e.native.end(),i(n);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),i()})})};xt.prototype.connect=function(i){if(i){this._connect(i);return}return new this._Promise((e,t)=>{this._connect(r=>{r?t(r):e()})})};xt.prototype.query=function(i,e,t){let r,n,s,a,o;if(i==null)throw new TypeError("Client was passed a null or undefined query");if(typeof i.submit=="function")s=i.query_timeout||this.connectionParameters.query_timeout,n=r=i,typeof e=="function"&&(i.callback=e);else if(s=i.query_timeout||this.connectionParameters.query_timeout,r=new s2(i,e,t),!r.callback){let c,l;n=new this._Promise((p,u)=>{c=p,l=u}).catch(p=>{throw Error.captureStackTrace(p),p}),r.callback=(p,u)=>p?l(p):c(u)}return s&&(o=r.callback,a=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),o(c),r.callback=()=>{};let l=this._queryQueue.indexOf(r);l>-1&&this._queryQueue.splice(l,1),this._pulseQueryQueue()},s),r.callback=(c,l)=>{clearTimeout(a),o(c,l)}),this._queryable?this._ending?(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(r),this._pulseQueryQueue(),n):(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};xt.prototype.end=function(i){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,i));let t;return i||(t=new this._Promise(function(r,n){i=s=>s?n(s):r()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),i&&i()})}),t};xt.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};xt.prototype._pulseQueryQueue=function(i){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){i||this.emit("drain");return}this._activeQuery=e,e.submit(this);let t=this;e.once("_done",function(){t._pulseQueryQueue()})};xt.prototype.cancel=function(i){this._activeQuery===i?this.native.cancel(function(){}):this._queryQueue.indexOf(i)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(i),1)};xt.prototype.ref=function(){};xt.prototype.unref=function(){};xt.prototype.setTypeParser=function(i,e,t){return this._types.setTypeParser(i,e,t)};xt.prototype.getTypeParser=function(i,e){return this._types.getTypeParser(i,e)}});var bm=g((cK,c2)=>{"use strict";c2.exports=o2()});var wl=g((pK,Va)=>{"use strict";var Gz=KT(),Wz=$a(),Kz=dm(),Zz=zf(),Xz=ts(),Jz=YT(),Yz=pl(),{DatabaseError:eF}=lm(),{escapeIdentifier:tF,escapeLiteral:iF}=ts(),rF=i=>class extends Jz{constructor(t){super(t,i)}},wm=function(i){this.defaults=Wz,this.Client=i,this.Query=this.Client.Query,this.Pool=rF(this.Client),this._pools=[],this.Connection=Kz,this.types=Ua(),this.DatabaseError=eF,this.TypeOverrides=Yz,this.escapeIdentifier=tF,this.escapeLiteral=iF,this.Result=Zz,this.utils=Xz};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Va.exports=new wm(bm()):(Va.exports=new wm(Gz),Object.defineProperty(Va.exports,"native",{configurable:!0,enumerable:!1,get(){let i=null;try{i=new wm(bm())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Va.exports,"native",{value:i}),i}}))});var At,uK,dK,fK,mK,hK,gK,vK,xK,yK,bK,wK,rr,_l=S(()=>{At=dt(wl(),1),uK=At.default.Client,dK=At.default.Pool,fK=At.default.Connection,mK=At.default.types,hK=At.default.Query,gK=At.default.DatabaseError,vK=At.default.escapeIdentifier,xK=At.default.escapeLiteral,yK=At.default.Result,bK=At.default.TypeOverrides,wK=At.default.defaults,rr=At.default});function w(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,v))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(i).constructor;if(t)for(;t;){if(v in t&&t[v]===e[v])return!0;t=Object.getPrototypeOf(t)}return!1}var v,SK,A=S(()=>{v=Symbol.for("drizzle:entityKind"),SK=Symbol.for("drizzle:hasOwnEntityKind")});var _m,Sl,El,kl=S(()=>{A();_m=class{static[v]="ConsoleLogWriter";write(e){console.log(e)}},Sl=class{static[v]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new _m}logQuery(e,t){let r=t.map(s=>{try{return JSON.stringify(s)}catch{return String(s)}}),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},El=class{static[v]="NoopLogger";logQuery(){}}});var Je,Ti=S(()=>{A();Je=class{static[v]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}});var re,pi=S(()=>{A();re=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[v]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Tl,Sm=S(()=>{A();Tl=class{static[v]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var Zt,Cl=S(()=>{Zt=Symbol.for("drizzle:Name")});var Al,Em,km=S(()=>{A();Cl();Al=class{static[v]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:n,foreignColumns:s}=e();return{name:r,columns:n,foreignTable:s[0].table,foreignColumns:s}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Em(e,this)}},Em=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[v]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(o=>o.name),s=r.map(o=>o.name),a=[this.table[Zt],...n,r[0].table[Zt],...s];return e??`${a.join("_")}_fk`}}});function Pl(i,...e){return i(...e)}var Tm=S(()=>{});function Pm(i,e){return`${i[Zt]}_${e.join("_")}_unique`}var Cm,l2,Am,Nm=S(()=>{A();Cl();Cm=class{constructor(e,t){this.name=t,this.columns=e}static[v]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Am(e,this.columns,this.nullsNotDistinctConfig,this.name)}},l2=class{static[v]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new Cm(e,this.name)}},Am=class{constructor(e,t,r,n){this.table=e,this.columns=t,this.name=n??Pm(this.table,this.columns.map(s=>s.name)),this.nullsNotDistinct=r}static[v]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function p2(i,e,t){for(let r=e;r<i.length;r++){let n=i[r];if(n==="\\"){r++;continue}if(n==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(n===","||n==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function u2(i,e=0){let t=[],r=e,n=!1;for(;r<i.length;){let s=i[r];if(s===","){(n||r===e)&&t.push(""),n=!0,r++;continue}if(n=!1,s==="\\"){r+=2;continue}if(s==='"'){let[c,l]=p2(i,r+1,!0);t.push(c),r=l;continue}if(s==="}")return[t,r+1];if(s==="{"){let[c,l]=u2(i,r+1);t.push(c),r=l;continue}let[a,o]=p2(i,r,!1);t.push(a),r=o}return[t,r]}function d2(i){let[e]=u2(i,1);return e}function Om(i){return`{${i.map(e=>Array.isArray(e)?Om(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Im=S(()=>{});var M,C,jm,ls,qm,Mm,Z=S(()=>{Sm();pi();A();km();Tm();Nm();Im();M=class extends Tl{foreignKeyConfigs=[];static[v]="PgColumnBuilder";array(e){return new qm(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>Pl((s,a)=>{let o=new Al(()=>{let c=s();return{columns:[e],foreignColumns:[c]}});return a.onUpdate&&o.onUpdate(a.onUpdate),a.onDelete&&o.onDelete(a.onDelete),o.build(t)},r,n))}buildExtraConfigColumn(e){return new jm(e,this.config)}},C=class extends re{constructor(e,t){t.uniqueName||(t.uniqueName=Pm(e,[t.name])),super(e,t),this.table=e}static[v]="PgColumn"},jm=class extends C{static[v]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},ls=class{static[v]="IndexedColumn";constructor(e,t,r,n){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=n}name;keyAsName;type;indexConfig},qm=class extends M{static[v]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new Mm(e,this.config,t)}},Mm=class i extends C{constructor(e,t,r,n){super(e,t),this.baseColumn=r,this.range=n,this.size=t.size}size;static[v]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=d2(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(n=>n===null?null:w(this.baseColumn,i)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?r:Om(r)}}});function f2(i){return!!i&&typeof i=="function"&&Rm in i&&i[Rm]===!0}function m2(i,e,t){let r=Object.assign(n=>new Lm(n??"",r),{enumName:i,enumValues:e,schema:t,[Rm]:!0});return r}var Rm,Lm,Dm,Nl=S(()=>{A();Z();Rm=Symbol.for("drizzle:isPgEnum");Lm=class extends M{static[v]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Dm(e,this.config)}},Dm=class extends C{static[v]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}});var Re,ps,ui=S(()=>{A();Re=class{static[v]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}},ps=class extends Re{static[v]="WithSubquery"}});var h2,g2=S(()=>{h2="0.39.3"});var Bm,zm,he,Ci=S(()=>{Tm();g2();he={startActiveSpan(i,e){return Bm?(zm||(zm=Bm.trace.getTracer("drizzle-orm",h2)),Pl((t,r)=>r.startActiveSpan(i,n=>{try{return e(n)}catch(s){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:s instanceof Error?s.message:"Unknown error"}),s}finally{n.end()}}),Bm,zm)):e()}}});var ge,Ai=S(()=>{ge=Symbol.for("drizzle:ViewBaseConfig")});function $m(i){return typeof i=="object"&&i!==null&&y2 in i}function yt(i){return i[Zt]}function Lr(i){return`${i[Ol]??"public"}.${i[Zt]}`}var Ol,Il,v2,Fm,Um,Ga,x2,y2,O,bt=S(()=>{A();Cl();Ol=Symbol.for("drizzle:Schema"),Il=Symbol.for("drizzle:Columns"),v2=Symbol.for("drizzle:ExtraConfigColumns"),Fm=Symbol.for("drizzle:OriginalName"),Um=Symbol.for("drizzle:BaseName"),Ga=Symbol.for("drizzle:IsAlias"),x2=Symbol.for("drizzle:ExtraConfigBuilder"),y2=Symbol.for("drizzle:IsDrizzleTable"),O=class{static[v]="Table";static Symbol={Name:Zt,Schema:Ol,OriginalName:Fm,Columns:Il,ExtraConfigColumns:v2,BaseName:Um,IsAlias:Ga,ExtraConfigBuilder:x2};[Zt];[Fm];[Ol];[Il];[v2];[Um];[Ga]=!1;[y2]=!0;[x2]=void 0;constructor(e,t,r){this[Zt]=this[Fm]=e,this[Ol]=t,this[Um]=r}}});function Hm(i){return i!=null&&typeof i.getSQL=="function"}function nF(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}function w2(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}function x(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new Le(i[0]));for(let[r,n]of e.entries())t.push(n,new Le(i[r+1]));return new I(t)}function Qm(i,e){return i.map(t=>{if(w(t,Pi)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(w(t,wt)&&w(t.value,Pi)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}function k2(i){return typeof i=="object"&&i!==null&&E2 in i}var b2,Le,I,Wa,_2,S2,gZ,wt,Pi,E2,ct,De=S(()=>{A();Nl();ui();Ci();Ai();pi();bt();b2=class{static[v]="FakePrimitiveParam"};Le=class{static[v]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new I([this])}},I=class i{constructor(e){this.queryChunks=e}static[v]="SQL";decoder=_2;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return he.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:s,escapeParam:a,prepareTyping:o,inlineParams:c,paramStartIndex:l}=r;return nF(e.map(p=>{if(w(p,Le))return{sql:p.value.join(""),params:[]};if(w(p,Wa))return{sql:s(p.value),params:[]};if(p===void 0)return{sql:"",params:[]};if(Array.isArray(p)){let u=[new Le("(")];for(let[d,f]of p.entries())u.push(f),d<p.length-1&&u.push(new Le(", "));return u.push(new Le(")")),this.buildQueryFromSourceParams(u,r)}if(w(p,i))return this.buildQueryFromSourceParams(p.queryChunks,{...r,inlineParams:c||p.shouldInlineParams});if(w(p,O)){let u=p[O.Symbol.Schema],d=p[O.Symbol.Name];return{sql:u===void 0||p[Ga]?s(d):s(u)+"."+s(d),params:[]}}if(w(p,re)){let u=n.getColumnCasing(p);if(t.invokeSource==="indexes")return{sql:s(u),params:[]};let d=p.table[O.Symbol.Schema];return{sql:p.table[Ga]||d===void 0?s(p.table[O.Symbol.Name])+"."+s(u):s(d)+"."+s(p.table[O.Symbol.Name])+"."+s(u),params:[]}}if(w(p,ct)){let u=p[ge].schema,d=p[ge].name;return{sql:u===void 0||p[ge].isAlias?s(d):s(u)+"."+s(d),params:[]}}if(w(p,wt)){if(w(p.value,Pi))return{sql:a(l.value++,p),params:[p],typings:["none"]};let u=p.value===null?null:p.encoder.mapToDriverValue(p.value);if(w(u,i))return this.buildQueryFromSourceParams([u],r);if(c)return{sql:this.mapInlineParam(u,r),params:[]};let d=["none"];return o&&(d=[o(p.encoder)]),{sql:a(l.value++,u),params:[u],typings:d}}return w(p,Pi)?{sql:a(l.value++,p),params:[p],typings:["none"]}:w(p,i.Aliased)&&p.fieldAlias!==void 0?{sql:s(p.fieldAlias),params:[]}:w(p,Re)?p._.isWith?{sql:s(p._.alias),params:[]}:this.buildQueryFromSourceParams([new Le("("),p._.sql,new Le(") "),new Wa(p._.alias)],r):f2(p)?p.schema?{sql:s(p.schema)+"."+s(p.enumName),params:[]}:{sql:s(p.enumName),params:[]}:Hm(p)?p.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([p.getSQL()],r):this.buildQueryFromSourceParams([new Le("("),p.getSQL(),new Le(")")],r):c?{sql:this.mapInlineParam(p,r),params:[]}:{sql:a(l.value++,p),params:[p],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new i.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Wa=class{constructor(e){this.value=e}static[v]="Name";brand;getSQL(){return new I([this])}};_2={mapFromDriverValue:i=>i},S2={mapToDriverValue:i=>i},gZ={..._2,...S2},wt=class{constructor(e,t=S2){this.value=e,this.encoder=t}static[v]="Param";brand;getSQL(){return new I([this])}};(i=>{function e(){return new I([])}i.empty=e;function t(c){return new I(c)}i.fromList=t;function r(c){return new I([new Le(c)])}i.raw=r;function n(c,l){let p=[];for(let[u,d]of c.entries())u>0&&l!==void 0&&p.push(l),p.push(d);return new I(p)}i.join=n;function s(c){return new Wa(c)}i.identifier=s;function a(c){return new Pi(c)}i.placeholder=a;function o(c,l){return new wt(c,l)}i.param=o})(x||(x={}));(i=>{class e{constructor(r,n){this.sql=r,this.fieldAlias=n}static[v]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(I||(I={}));Pi=class{constructor(e){this.name=e}static[v]="Placeholder";getSQL(){return new I([this])}};E2=Symbol.for("drizzle:IsDrizzleView"),ct=class{static[v]="View";[ge];[E2]=!0;constructor({name:e,schema:t,selectedFields:r,query:n}){this[ge]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new I([this])}};re.prototype.getSQL=function(){return new I([this])};O.prototype.getSQL=function(){return new I([this])};Re.prototype.getSQL=function(){return new I([this])}});function Ka(i,e){return new Proxy(i,new us(e,!1))}function di(i,e){return new Proxy(i,new Dr(new Proxy(i.table,new us(e,!1))))}function Vm(i,e){return new I.Aliased(Za(i.sql,e),i.fieldAlias)}function Za(i,e){return x.join(i.queryChunks.map(t=>w(t,re)?di(t,e):w(t,I)?Za(t,e):w(t,I.Aliased)?Vm(t,e):t))}var Dr,us,T2,jl=S(()=>{pi();A();De();bt();Ai();Dr=class{constructor(e){this.table=e}static[v]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},us=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[v]="TableAliasProxyHandler";get(e,t){if(t===O.Symbol.IsAlias)return!0;if(t===O.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===O.Symbol.OriginalName)return this.alias;if(t===ge)return{...e[ge],name:this.alias,isAlias:!0};if(t===O.Symbol.Columns){let n=e[O.Symbol.Columns];if(!n)return n;let s={};return Object.keys(n).map(a=>{s[a]=new Proxy(n[a],new Dr(new Proxy(e,this)))}),s}let r=e[t];return w(r,re)?new Proxy(r,new Dr(new Proxy(e,this))):r}},T2=class{constructor(e){this.alias=e}static[v]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Ka(e.sourceTable,this.alias):e[t]}}});var pe,nr=S(()=>{jl();pi();A();De();ui();Ai();pe=class i{static[v]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ge)return{...e[ge],selectedFields:new Proxy(e[ge].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(w(e,Re)?e._.selectedFields:w(e,ct)?e[ge].selectedFields:e)[t];if(w(n,I.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let s=n.clone();return s.isSelectionField=!0,s}if(w(n,I)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return w(n,re)?this.config.alias?new Proxy(n,new Dr(new Proxy(n.table,new us(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new i(this.config))}}});function C2(i,e,t){let r={},n=i.reduce((s,{path:a,field:o},c)=>{let l;w(o,re)?l=o:w(o,I)?l=o.decoder:l=o.sql.decoder;let p=s;for(let[u,d]of a.entries())if(u<a.length-1)d in p||(p[d]={}),p=p[d];else{let f=e[c],m=p[d]=f===null?null:l.mapFromDriverValue(f);if(t&&w(o,re)&&a.length===2){let h=a[0];h in r?typeof r[h]=="string"&&r[h]!==yt(o.table)&&(r[h]=!1):r[h]=m===null?yt(o.table):!1}}return s},{});if(t&&Object.keys(r).length>0)for(let[s,a]of Object.entries(r))typeof a=="string"&&!t[a]&&(n[s]=null);return n}function zt(i,e){return Object.entries(i).reduce((t,[r,n])=>{if(typeof r!="string")return t;let s=e?[...e,r]:[r];return w(n,re)||w(n,I)||w(n,I.Aliased)?t.push({path:s,field:n}):w(n,O)?t.push(...zt(n[O.Symbol.Columns],s)):t.push(...zt(n,s)),t},[])}function Xa(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[n,s]of t.entries())if(s!==r[n])return!1;return!0}function ql(i,e){let t=Object.entries(e).filter(([,r])=>r!==void 0).map(([r,n])=>w(n,I)||w(n,re)?[r,n]:[r,new wt(n,i[O.Symbol.Columns][r])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function A2(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function Br(i){return i[O.Symbol.Columns]}function P2(i){return i[ge].selectedFields}function Ni(i){return w(i,Re)?i._.alias:w(i,ct)?i[ge].name:w(i,I)?void 0:i[O.Symbol.IsAlias]?i[O.Symbol.Name]:i[O.Symbol.BaseName]}function Y(i,e){return{name:typeof i=="string"&&i.length>0?i:"",config:typeof i=="object"?i:e}}function N2(i){if(typeof i!="object"||i===null||i.constructor.name!=="Object")return!1;if("logger"in i){let e=typeof i.logger;return!(e!=="boolean"&&(e!=="object"||typeof i.logger.logQuery!="function")&&e!=="undefined")}if("schema"in i){let e=typeof i.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in i){let e=typeof i.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in i)return!(i.mode!=="default"||i.mode!=="planetscale"||i.mode!==void 0);if("connection"in i){let e=typeof i.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in i){let e=typeof i.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(i).length===0}var ue=S(()=>{pi();A();De();ui();bt();Ai()});var Ja,O2=S(()=>{A();Ti();nr();bt();Ci();ue();Ja=class extends Je{constructor(e,t,r,n){super(),this.session=t,this.dialect=r,this.config={table:e,withList:n}}static[v]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[O.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=zt(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return he.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>he.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:yt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function sF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function aF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,r,n)=>{let s=n===0?r.toLowerCase():`${r[0].toUpperCase()}${r.slice(1)}`;return t+s},"")}function oF(i){return i}var Ml,I2=S(()=>{A();bt();Ml=class{static[v]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?sF:e==="camelCase"?aF:oF}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[O.Symbol.Schema]??"public",r=e.table[O.Symbol.OriginalName],n=`${t}.${r}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[O.Symbol.Schema]??"public",r=e[O.Symbol.OriginalName],n=`${t}.${r}`;if(!this.cachedTables[n]){for(let s of Object.values(e[O.Symbol.Columns])){let a=`${n}.${s.name}`;this.cache[a]=this.convert(s.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ya,Rl,Ll=S(()=>{A();Ya=class extends Error{static[v]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Rl=class extends Ya{static[v]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Oi,eo=S(()=>{A();Z();Oi=class extends M{static[v]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function j2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Gm(t):new Km(t)}var Gm,Wm,Km,Zm,Xm=S(()=>{A();ue();Z();eo();Gm=class extends Oi{static[v]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Wm(e,this.config)}},Wm=class extends C{static[v]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Km=class extends Oi{static[v]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Zm(e,this.config)}},Zm=class extends C{static[v]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function q2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Jm(t):new eh(t)}var Jm,Ym,eh,th,ih=S(()=>{A();ue();Z();Jm=class extends M{static[v]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ym(e,this.config)}},Ym=class extends C{static[v]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},eh=class extends M{static[v]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new th(e,this.config)}},th=class extends C{static[v]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function ds(i){return new rh(i??"")}var rh,nh,sh=S(()=>{A();Z();rh=class extends M{static[v]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new nh(e,this.config)}},nh=class extends C{static[v]="PgBoolean";getSQLType(){return"boolean"}}});function M2(i,e={}){let{name:t,config:r}=Y(i,e);return new ah(t,r)}var ah,oh,ch=S(()=>{A();ue();Z();ah=class extends M{static[v]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new oh(e,this.config)}},oh=class extends C{static[v]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function R2(i){return new lh(i??"")}var lh,ph,uh=S(()=>{A();Z();lh=class extends M{static[v]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new ph(e,this.config)}},ph=class extends C{static[v]="PgCidr";getSQLType(){return"cidr"}}});function L2(i){return(e,t)=>{let{name:r,config:n}=Y(e,t);return new dh(r,n,i)}}var dh,fh,mh=S(()=>{A();ue();Z();dh=class extends M{static[v]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new fh(e,this.config)}},fh=class extends C{static[v]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var fi,Dl=S(()=>{A();De();Z();fi=class extends M{static[v]="PgDateColumnBaseBuilder";defaultNow(){return this.default(x`now()`)}}});function D2(i,e){let{name:t,config:r}=Y(i,e);return r?.mode==="date"?new hh(t):new gh(t)}var hh,to,gh,io,vh=S(()=>{A();ue();Z();Dl();hh=class extends fi{static[v]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new to(e,this.config)}},to=class extends C{static[v]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},gh=class extends fi{static[v]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new io(e,this.config)}},io=class extends C{static[v]="PgDateString";getSQLType(){return"date"}}});function B2(i){return new xh(i??"")}var xh,yh,bh=S(()=>{A();Z();xh=class extends M{static[v]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new yh(e,this.config)}},yh=class extends C{static[v]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function z2(i){return new wh(i??"")}var wh,_h,Sh=S(()=>{A();Z();wh=class extends M{static[v]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new _h(e,this.config)}},_h=class extends C{static[v]="PgInet";getSQLType(){return"inet"}}});function Ft(i){return new Eh(i??"")}var Eh,kh,Th=S(()=>{A();Z();eo();Eh=class extends Oi{static[v]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new kh(e,this.config)}},kh=class extends C{static[v]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function F2(i,e={}){let{name:t,config:r}=Y(i,e);return new Ch(t,r)}var Ch,Ah,Ph=S(()=>{A();ue();Z();Ch=class extends M{static[v]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new Ah(e,this.config)}},Ah=class extends C{static[v]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}});function U2(i){return new Nh(i??"")}var Nh,ro,Oh=S(()=>{A();Z();Nh=class extends M{static[v]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ro(e,this.config)}},ro=class extends C{static[v]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function $2(i){return new Ih(i??"")}var Ih,no,jh=S(()=>{A();Z();Ih=class extends M{static[v]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new no(e,this.config)}},no=class extends C{static[v]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function H2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new qh(t):new Rh(t)}var qh,Mh,Rh,Lh,Dh=S(()=>{A();ue();Z();qh=class extends M{static[v]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Mh(e,this.config)}},Mh=class extends C{static[v]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Rh=class extends M{static[v]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Lh(e,this.config)}},Lh=class extends C{static[v]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function Q2(i){return new Bh(i??"")}var Bh,zh,Fh=S(()=>{A();Z();Bh=class extends M{static[v]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new zh(e,this.config)}},zh=class extends C{static[v]="PgMacaddr";getSQLType(){return"macaddr"}}});function V2(i){return new Uh(i??"")}var Uh,$h,Hh=S(()=>{A();Z();Uh=class extends M{static[v]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new $h(e,this.config)}},$h=class extends C{static[v]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function Vh(i,e){let{name:t,config:r}=Y(i,e);return new Qh(t,r?.precision,r?.scale)}var Qh,so,Xt,Gh=S(()=>{A();ue();Z();Qh=class extends M{static[v]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new so(e,this.config)}},so=class extends C{static[v]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Xt=Vh});function G2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new Wh(t):new Zh(t)}var Wh,Kh,Zh,Xh,Jh=S(()=>{A();ue();Z();Wh=class extends M{static[v]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Kh(e,this.config)}},Kh=class extends C{static[v]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Zh=class extends M{static[v]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new Xh(e,this.config)}},Xh=class extends C{static[v]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function cF(i){let e=[];for(let t=0;t<i.length;t+=2)e.push(Number.parseInt(i.slice(t,t+2),16));return new Uint8Array(e)}function W2(i,e){let t=new ArrayBuffer(8),r=new DataView(t);for(let n=0;n<8;n++)r.setUint8(n,i[e+n]);return r.getFloat64(0,!0)}function Yh(i){let e=cF(i),t=0,r=e[t];t+=1;let n=new DataView(e.buffer),s=n.getUint32(t,r===1);t+=4;let a;if(s&536870912&&(a=n.getUint32(t,r===1),t+=4),(s&65535)===1){let o=W2(e,t);t+=8;let c=W2(e,t);return t+=8,[o,c]}throw new Error("Unsupported geometry type")}var K2=S(()=>{});function Z2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new eg(t):new ig(t)}var eg,tg,ig,rg,ng=S(()=>{A();ue();Z();K2();eg=class extends M{static[v]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new tg(e,this.config)}},tg=class extends C{static[v]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Yh(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},ig=class extends M{static[v]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new rg(e,this.config)}},rg=class extends C{static[v]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=Yh(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function X2(i){return new sg(i??"")}var sg,ag,og=S(()=>{A();Z();sg=class extends M{static[v]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ag(e,this.config)}},ag=class extends C{static[v]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function mi(i){return new cg(i??"")}var cg,lg,pg=S(()=>{A();Z();cg=class extends M{static[v]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new lg(e,this.config)}},lg=class extends C{static[v]="PgSerial";getSQLType(){return"serial"}}});function J2(i){return new ug(i??"")}var ug,dg,fg=S(()=>{A();Z();eo();ug=class extends Oi{static[v]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new dg(e,this.config)}},dg=class extends C{static[v]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Y2(i){return new mg(i??"")}var mg,hg,gg=S(()=>{A();Z();mg=class extends M{static[v]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new hg(e,this.config)}},hg=class extends C{static[v]="PgSmallSerial";getSQLType(){return"smallserial"}}});function K(i,e={}){let{name:t,config:r}=Y(i,e);return new vg(t,r)}var vg,xg,yg=S(()=>{A();ue();Z();vg=class extends M{static[v]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new xg(e,this.config)}},xg=class extends C{static[v]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function eC(i,e={}){let{name:t,config:r}=Y(i,e);return new bg(t,r.withTimezone??!1,r.precision)}var bg,ao,wg=S(()=>{A();ue();Z();Dl();bg=class extends fi{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static[v]="PgTimeBuilder";build(e){return new ao(e,this.config)}},ao=class extends C{static[v]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function hi(i,e={}){let{name:t,config:r}=Y(i,e);return r?.mode==="string"?new Sg(t,r.withTimezone??!1,r.precision):new _g(t,r?.withTimezone??!1,r?.precision)}var _g,oo,Sg,co,Eg=S(()=>{A();ue();Z();Dl();_g=class extends fi{static[v]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new oo(e,this.config)}},oo=class extends C{static[v]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Sg=class extends fi{static[v]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new co(e,this.config)}},co=class extends C{static[v]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function tC(i){return new kg(i??"")}var kg,lo,Tg=S(()=>{A();De();Z();kg=class extends M{static[v]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(x`gen_random_uuid()`)}build(e){return new lo(e,this.config)}},lo=class extends C{static[v]="PgUUID";getSQLType(){return"uuid"}}});function iC(i,e={}){let{name:t,config:r}=Y(i,e);return new Cg(t,r)}var Cg,Ag,Pg=S(()=>{A();ue();Z();Cg=class extends M{static[v]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ag(e,this.config)}},Ag=class extends C{static[v]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function rC(i,e){let{name:t,config:r}=Y(i,e);return new Ng(t,r)}var Ng,Og,Ig=S(()=>{A();ue();Z();Ng=class extends M{static[v]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new Og(e,this.config)}},Og=class extends C{static[v]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function nC(i,e){let{name:t,config:r}=Y(i,e);return new jg(t,r)}var jg,qg,Mg=S(()=>{A();ue();Z();jg=class extends M{static[v]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new qg(e,this.config)}},qg=class extends C{static[v]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensio
==> Running 'npm run start'
> rest-express@1.0.0 start
> npm run db:push && node dist/index.js
> rest-express@1.0.0 db:push
> drizzle-kit push
No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/render/project/src/drizzle.config.ts'
Using 'pg' driver for database querying
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[✓] Pulling schema from database...
Is plain_password column in users table created or renamed from another column?
❯ + plain_password                    create column
  ~ kyc_document_url › plain_password rename column[2026-01-15 19:15:18] DEBUG Creating transport: nodemailer (7.0.12; +https://nodemailer.com/; SMTP (pool)/7.0.12[client:7.0.12])
7:15:19 PM [express] serving on port 10000
7:15:28 PM [express] GET /api/user 401 in 13ms
file:///opt/render/project/src/dist/index.js:71
`);Qa.write(UT.format.apply(UT,e))}}Object.defineProperty(ki.exports,"isWin",{get:function(){return vl},set:function(i){vl=i}});ki.exports.warnTo=function(i){var e=Qa;return Qa=i,e};ki.exports.getFileName=function(i){var e=i||process.env,t=e.PGPASSFILE||(vl?FT.join(e.APPDATA||"./","postgresql","pgpass.conf"):FT.join(e.HOME||"./",".pgpass"));return t};ki.exports.usePgPass=function(i,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:vl?!0:(e=e||"<unkn>",Az(i.mode)?i.mode&(Ez|kz)?(mm('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(mm('WARNING: password file "%s" is not a plain file',e),!1))};var Nz=ki.exports.match=function(i,e){return as.slice(0,-1).reduce(function(t,r,n){return n==1&&Number(i[r]||Sz)===Number(e[r])?t&&!0:t&&(e[r]==="*"||e[r]===i[r])},!0)};ki.exports.getPassword=function(i,e,t){var r,n=e.pipe(_z());function s(c){var l=Oz(c);l&&Iz(l)&&Nz(i,l)&&(r=l[Pz],n.end())}var a=function(){e.destroy(),t(r)},o=function(c){e.destroy(),mm("WARNING: error on reading file: %s",c),t(void 0)};e.on("error",o),n.on("data",s).on("end",a).on("error",o)};var Oz=ki.exports.parseLine=function(i){if(i.length<11||i.match(/^\s+#/))return null;for(var e="",t="",r=0,n=0,s=0,a={},o=!1,c=function(p,u,d){var f=i.substring(u,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(f=f.replace(/\\([:\\])/g,"$1")),a[as[p]]=f},l=0;l<i.length-1;l+=1){if(e=i.charAt(l+1),t=i.charAt(l),o=r==fm-1,o){c(r,n);break}l>=0&&e==":"&&t!=="\\"&&(c(r,n,l+1),n=l+2,r+=1)}return a=Object.keys(a).length===fm?a:null,a},Iz=ki.exports.isValidEntry=function(i){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<as.length;t+=1){var r=e[t],n=i[as[t]]||"",s=r(n);if(!s)return!1}return!0}});var QT=g((rK,hm)=>{"use strict";var iK=b("path"),HT=b("fs"),xl=$T();hm.exports=function(i,e){var t=xl.getFileName();HT.stat(t,function(r,n){if(r||!xl.usePgPass(n,t))return e(void 0);var s=HT.createReadStream(t);xl.getPassword(i,s,e)})};hm.exports.warnTo=xl.warnTo});var KT=g((nK,WT)=>{"use strict";var jz=b("events").EventEmitter,VT=ts(),gm=dT(),qz=pl(),Mz=Df(),GT=kT(),Rz=$a(),Lz=dm(),Dz=Mf(),yl=class extends jz{constructor(e){super(),this.connectionParameters=new Mz(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let t=e||{};this._Promise=t.Promise||global.Promise,this._types=new qz(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new Lz({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||Rz.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=r=>{process.nextTick(()=>{r.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){let t=this,r=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{r._ending=!0,r.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){t.ssl?r.requestSsl():r.startup(t.getStartupConf())}),r.on("sslconnect",function(){r.startup(t.getStartupConf())}),this._attachListeners(r),r.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,r)=>{this._connect(n=>{n?r(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(r=>{if(r!==void 0){if(typeof r!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=r}else this.connectionParameters.password=this.password=null;e()}).catch(r=>{t.emit("error",r)});else if(this.password!==null)e();else try{QT()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(r){this.emit("error",r)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await Dz.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=gm.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await gm.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{gm.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;return r&&(t.application_name=r),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){let r=this.connection;this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){r.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,r){return this._types.setTypeParser(e,t,r)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return VT.escapeIdentifier(e)}escapeLiteral(e){return VT.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,r){let n,s,a,o,c;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(a=e.query_timeout||this.connectionParameters.query_timeout,n=new GT(e,t,r),n.callback||(s=new this._Promise((l,p)=>{n.callback=(u,d)=>u?p(u):l(d)}).catch(l=>{throw Error.captureStackTrace(l),l}))),a&&(c=n.callback,o=setTimeout(()=>{let l=new Error("Query read timeout");process.nextTick(()=>{n.handleError(l,this.connection)}),c(l),n.callback=()=>{};let p=this.queryQueue.indexOf(n);p>-1&&this.queryQueue.splice(p,1),this._pulseQueryQueue()},a),n.callback=(l,p)=>{clearTimeout(o),c(l,p)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(n),this._pulseQueryQueue(),s):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};yl.Query=GT;WT.exports=yl});var YT=g((sK,JT)=>{"use strict";var Bz=b("events").EventEmitter,ZT=function(){},XT=(i,e)=>{let t=i.findIndex(e);return t===-1?void 0:i.splice(t,1)[0]},vm=class{constructor(e,t,r){this.client=e,this.idleListener=t,this.timeoutId=r}},os=class{constructor(e){this.callback=e}};function zz(){throw new Error("Release called on client which has already been released to the pool.")}function bl(i,e){if(e)return{callback:e,result:void 0};let t,r,n=function(a,o){a?t(a):r(o)},s=new i(function(a,o){r=a,t=o}).catch(a=>{throw Error.captureStackTrace(a),a});return{callback:n,result:s}}function Fz(i,e){return function t(r){r.client=e,e.removeListener("error",t),e.on("error",()=>{i.log("additional client error after disconnection due to error",r)}),i._remove(e),i.emit("error",r,e)}}var xm=class extends Bz{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||wl().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let r=t.client;r.ref&&r.ref();let n=t.idleListener;return this._acquireClient(r,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,t){let r=XT(this._idle,s=>s.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(s=>s!==e);let n=this;e.end(()=>{n.emit("remove",e),typeof t=="function"&&t()})}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=bl(this.Promise,e),r=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new os(t.callback)),r;let n=(o,c,l)=>{clearTimeout(a),t.callback(o,c,l)},s=new os(n),a=setTimeout(()=>{XT(this._pendingQueue,o=>o.callback===n),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return a.unref&&a.unref(),this._pendingQueue.push(s),r}return this.newClient(new os(t.callback)),r}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let r=Fz(this,t);this.log("checking client timeout");let n,s=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(n&&clearTimeout(n),t.on("error",r),a)this.log("client failed to connect",a),this._clients=this._clients.filter(o=>o!==t),s&&(a=new Error("Connection terminated due to connection timeout",{cause:a})),this._pulseQueue(),e.timedOut||e.callback(a,void 0,ZT);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(l=>l.client===t)!==-1&&this._acquireClient(t,new os((l,p,u)=>u()),r,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),t.once("end",()=>clearTimeout(o))}return this._acquireClient(t,e,r,!0)}})}_acquireClient(e,t,r,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,r),e.removeListener("error",r),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,ZT);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let r=!1;return n=>{r&&zz(),r=!0,this._release(e,t,n)}}_release(e,t,r){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",r,e),r||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let s;this.options.idleTimeoutMillis&&this._isAboveMin()&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new vm(e,t,s)),this._pulseQueue()}query(e,t,r){if(typeof e=="function"){let s=bl(this.Promise,e);return setImmediate(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(r=t,t=void 0);let n=bl(this.Promise,r);return r=n.callback,this.connect((s,a)=>{if(s)return r(s);let o=!1,c=l=>{o||(o=!0,a.release(l),r(l))};a.once("error",c),this.log("dispatching query");try{a.query(e,t,(l,p)=>{if(this.log("query dispatched"),a.removeListener("error",c),!o)return o=!0,a.release(l),l?r(l):r(void 0,p)})}catch(l){return a.release(l),r(l)}}),n.result}end(e){if(this.log("ending"),this.ending){let r=new Error("Called end on pool more than once");return e?e(r):this.Promise.reject(r)}this.ending=!0;let t=bl(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};JT.exports=xm});var i2=g((aK,t2)=>{"use strict";var e2=b("events").EventEmitter,Uz=b("util"),ym=ts(),cs=t2.exports=function(i,e,t){e2.call(this),i=ym.normalizeQueryConfig(i,e,t),this.text=i.text,this.values=i.values,this.name=i.name,this.queryMode=i.queryMode,this.callback=i.callback,this.state="new",this._arrayMode=i.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(r){r==="row"&&(this._emitRowEvents=!0)}.bind(this))};Uz.inherits(cs,e2);var $z={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};cs.prototype.handleError=function(i){let e=this.native.pq.resultErrorFields();if(e)for(let t in e){let r=$z[t]||t;i[r]=e[t]}this.callback?this.callback(i):this.emit("error",i),this.state="error"};cs.prototype.then=function(i,e){return this._getPromise().then(i,e)};cs.prototype.catch=function(i){return this._getPromise().catch(i)};cs.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(i,e){this._once("end",i),this._once("error",e)}.bind(this)),this._promise)};cs.prototype.submit=function(i){this.state="running";let e=this;this.native=i.native,i.native.arrayMode=this._arrayMode;let t=function(r,n,s){if(i.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),r)return e.handleError(r);e._emitRowEvents&&(s.length>1?n.forEach((a,o)=>{a.forEach(c=>{e.emit("row",c,s[o])})}):n.forEach(function(a){e.emit("row",a,s)})),e.state="end",e.emit("end",s),e.callback&&e.callback(null,s)};if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let r=(this.values||[]).map(ym.prepareValue);if(i.namedQueries[this.name]){if(this.text&&i.namedQueries[this.name]!==this.text){let n=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(n)}return i.native.execute(this.name,r,t)}return i.native.prepare(this.name,this.text,r.length,function(n){return n?t(n):(i.namedQueries[e.name]=e.text,e.native.execute(e.name,r,t))})}else if(this.values){if(!Array.isArray(this.values)){let n=new Error("Query values must be an array");return t(n)}let r=this.values.map(ym.prepareValue);i.native.query(this.text,r,t)}else this.queryMode==="extended"?i.native.query(this.text,[],t):i.native.query(this.text,t)}});var o2=g((oK,a2)=>{"use strict";var r2;try{r2=b("pg-native")}catch(i){throw i}var Hz=pl(),n2=b("events").EventEmitter,Qz=b("util"),Vz=Df(),s2=i2(),xt=a2.exports=function(i){n2.call(this),i=i||{},this._Promise=i.Promise||global.Promise,this._types=new Hz(i.types),this.native=new r2({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new Vz(i);i.nativeConnectionString&&(e.nativeConnectionString=i.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};xt.Query=s2;Qz.inherits(xt,n2);xt.prototype._errorAllQueries=function(i){let e=t=>{process.nextTick(()=>{t.native=this.native,t.handleError(i)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};xt.prototype._connect=function(i){let e=this;if(this._connecting){process.nextTick(()=>i(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,r){if(e.connectionParameters.nativeConnectionString&&(r=e.connectionParameters.nativeConnectionString),t)return i(t);e.native.connect(r,function(n){if(n)return e.native.end(),i(n);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),i()})})};xt.prototype.connect=function(i){if(i){this._connect(i);return}return new this._Promise((e,t)=>{this._connect(r=>{r?t(r):e()})})};xt.prototype.query=function(i,e,t){let r,n,s,a,o;if(i==null)throw new TypeError("Client was passed a null or undefined query");if(typeof i.submit=="function")s=i.query_timeout||this.connectionParameters.query_timeout,n=r=i,typeof e=="function"&&(i.callback=e);else if(s=i.query_timeout||this.connectionParameters.query_timeout,r=new s2(i,e,t),!r.callback){let c,l;n=new this._Promise((p,u)=>{c=p,l=u}).catch(p=>{throw Error.captureStackTrace(p),p}),r.callback=(p,u)=>p?l(p):c(u)}return s&&(o=r.callback,a=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),o(c),r.callback=()=>{};let l=this._queryQueue.indexOf(r);l>-1&&this._queryQueue.splice(l,1),this._pulseQueryQueue()},s),r.callback=(c,l)=>{clearTimeout(a),o(c,l)}),this._queryable?this._ending?(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(r),this._pulseQueryQueue(),n):(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};xt.prototype.end=function(i){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,i));let t;return i||(t=new this._Promise(function(r,n){i=s=>s?n(s):r()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),i&&i()})}),t};xt.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};xt.prototype._pulseQueryQueue=function(i){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){i||this.emit("drain");return}this._activeQuery=e,e.submit(this);let t=this;e.once("_done",function(){t._pulseQueryQueue()})};xt.prototype.cancel=function(i){this._activeQuery===i?this.native.cancel(function(){}):this._queryQueue.indexOf(i)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(i),1)};xt.prototype.ref=function(){};xt.prototype.unref=function(){};xt.prototype.setTypeParser=function(i,e,t){return this._types.setTypeParser(i,e,t)};xt.prototype.getTypeParser=function(i,e){return this._types.getTypeParser(i,e)}});var bm=g((cK,c2)=>{"use strict";c2.exports=o2()});var wl=g((pK,Va)=>{"use strict";var Gz=KT(),Wz=$a(),Kz=dm(),Zz=zf(),Xz=ts(),Jz=YT(),Yz=pl(),{DatabaseError:eF}=lm(),{escapeIdentifier:tF,escapeLiteral:iF}=ts(),rF=i=>class extends Jz{constructor(t){super(t,i)}},wm=function(i){this.defaults=Wz,this.Client=i,this.Query=this.Client.Query,this.Pool=rF(this.Client),this._pools=[],this.Connection=Kz,this.types=Ua(),this.DatabaseError=eF,this.TypeOverrides=Yz,this.escapeIdentifier=tF,this.escapeLiteral=iF,this.Result=Zz,this.utils=Xz};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Va.exports=new wm(bm()):(Va.exports=new wm(Gz),Object.defineProperty(Va.exports,"native",{configurable:!0,enumerable:!1,get(){let i=null;try{i=new wm(bm())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Va.exports,"native",{value:i}),i}}))});var At,uK,dK,fK,mK,hK,gK,vK,xK,yK,bK,wK,rr,_l=S(()=>{At=dt(wl(),1),uK=At.default.Client,dK=At.default.Pool,fK=At.default.Connection,mK=At.default.types,hK=At.default.Query,gK=At.default.DatabaseError,vK=At.default.escapeIdentifier,xK=At.default.escapeLiteral,yK=At.default.Result,bK=At.default.TypeOverrides,wK=At.default.defaults,rr=At.default});function w(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,v))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(i).constructor;if(t)for(;t;){if(v in t&&t[v]===e[v])return!0;t=Object.getPrototypeOf(t)}return!1}var v,SK,A=S(()=>{v=Symbol.for("drizzle:entityKind"),SK=Symbol.for("drizzle:hasOwnEntityKind")});var _m,Sl,El,kl=S(()=>{A();_m=class{static[v]="ConsoleLogWriter";write(e){console.log(e)}},Sl=class{static[v]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new _m}logQuery(e,t){let r=t.map(s=>{try{return JSON.stringify(s)}catch{return String(s)}}),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},El=class{static[v]="NoopLogger";logQuery(){}}});var Je,Ti=S(()=>{A();Je=class{static[v]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}});var re,pi=S(()=>{A();re=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[v]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Tl,Sm=S(()=>{A();Tl=class{static[v]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var Zt,Cl=S(()=>{Zt=Symbol.for("drizzle:Name")});var Al,Em,km=S(()=>{A();Cl();Al=class{static[v]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:n,foreignColumns:s}=e();return{name:r,columns:n,foreignTable:s[0].table,foreignColumns:s}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Em(e,this)}},Em=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[v]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(o=>o.name),s=r.map(o=>o.name),a=[this.table[Zt],...n,r[0].table[Zt],...s];return e??`${a.join("_")}_fk`}}});function Pl(i,...e){return i(...e)}var Tm=S(()=>{});function Pm(i,e){return`${i[Zt]}_${e.join("_")}_unique`}var Cm,l2,Am,Nm=S(()=>{A();Cl();Cm=class{constructor(e,t){this.name=t,this.columns=e}static[v]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Am(e,this.columns,this.nullsNotDistinctConfig,this.name)}},l2=class{static[v]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new Cm(e,this.name)}},Am=class{constructor(e,t,r,n){this.table=e,this.columns=t,this.name=n??Pm(this.table,this.columns.map(s=>s.name)),this.nullsNotDistinct=r}static[v]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function p2(i,e,t){for(let r=e;r<i.length;r++){let n=i[r];if(n==="\\"){r++;continue}if(n==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(n===","||n==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function u2(i,e=0){let t=[],r=e,n=!1;for(;r<i.length;){let s=i[r];if(s===","){(n||r===e)&&t.push(""),n=!0,r++;continue}if(n=!1,s==="\\"){r+=2;continue}if(s==='"'){let[c,l]=p2(i,r+1,!0);t.push(c),r=l;continue}if(s==="}")return[t,r+1];if(s==="{"){let[c,l]=u2(i,r+1);t.push(c),r=l;continue}let[a,o]=p2(i,r,!1);t.push(a),r=o}return[t,r]}function d2(i){let[e]=u2(i,1);return e}function Om(i){return`{${i.map(e=>Array.isArray(e)?Om(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Im=S(()=>{});var M,C,jm,ls,qm,Mm,Z=S(()=>{Sm();pi();A();km();Tm();Nm();Im();M=class extends Tl{foreignKeyConfigs=[];static[v]="PgColumnBuilder";array(e){return new qm(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>Pl((s,a)=>{let o=new Al(()=>{let c=s();return{columns:[e],foreignColumns:[c]}});return a.onUpdate&&o.onUpdate(a.onUpdate),a.onDelete&&o.onDelete(a.onDelete),o.build(t)},r,n))}buildExtraConfigColumn(e){return new jm(e,this.config)}},C=class extends re{constructor(e,t){t.uniqueName||(t.uniqueName=Pm(e,[t.name])),super(e,t),this.table=e}static[v]="PgColumn"},jm=class extends C{static[v]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},ls=class{static[v]="IndexedColumn";constructor(e,t,r,n){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=n}name;keyAsName;type;indexConfig},qm=class extends M{static[v]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new Mm(e,this.config,t)}},Mm=class i extends C{constructor(e,t,r,n){super(e,t),this.baseColumn=r,this.range=n,this.size=t.size}size;static[v]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=d2(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(n=>n===null?null:w(this.baseColumn,i)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?r:Om(r)}}});function f2(i){return!!i&&typeof i=="function"&&Rm in i&&i[Rm]===!0}function m2(i,e,t){let r=Object.assign(n=>new Lm(n??"",r),{enumName:i,enumValues:e,schema:t,[Rm]:!0});return r}var Rm,Lm,Dm,Nl=S(()=>{A();Z();Rm=Symbol.for("drizzle:isPgEnum");Lm=class extends M{static[v]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Dm(e,this.config)}},Dm=class extends C{static[v]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}});var Re,ps,ui=S(()=>{A();Re=class{static[v]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}},ps=class extends Re{static[v]="WithSubquery"}});var h2,g2=S(()=>{h2="0.39.3"});var Bm,zm,he,Ci=S(()=>{Tm();g2();he={startActiveSpan(i,e){return Bm?(zm||(zm=Bm.trace.getTracer("drizzle-orm",h2)),Pl((t,r)=>r.startActiveSpan(i,n=>{try{return e(n)}catch(s){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:s instanceof Error?s.message:"Unknown error"}),s}finally{n.end()}}),Bm,zm)):e()}}});var ge,Ai=S(()=>{ge=Symbol.for("drizzle:ViewBaseConfig")});function $m(i){return typeof i=="object"&&i!==null&&y2 in i}function yt(i){return i[Zt]}function Lr(i){return`${i[Ol]??"public"}.${i[Zt]}`}var Ol,Il,v2,Fm,Um,Ga,x2,y2,O,bt=S(()=>{A();Cl();Ol=Symbol.for("drizzle:Schema"),Il=Symbol.for("drizzle:Columns"),v2=Symbol.for("drizzle:ExtraConfigColumns"),Fm=Symbol.for("drizzle:OriginalName"),Um=Symbol.for("drizzle:BaseName"),Ga=Symbol.for("drizzle:IsAlias"),x2=Symbol.for("drizzle:ExtraConfigBuilder"),y2=Symbol.for("drizzle:IsDrizzleTable"),O=class{static[v]="Table";static Symbol={Name:Zt,Schema:Ol,OriginalName:Fm,Columns:Il,ExtraConfigColumns:v2,BaseName:Um,IsAlias:Ga,ExtraConfigBuilder:x2};[Zt];[Fm];[Ol];[Il];[v2];[Um];[Ga]=!1;[y2]=!0;[x2]=void 0;constructor(e,t,r){this[Zt]=this[Fm]=e,this[Ol]=t,this[Um]=r}}});function Hm(i){return i!=null&&typeof i.getSQL=="function"}function nF(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}function w2(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}function x(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new Le(i[0]));for(let[r,n]of e.entries())t.push(n,new Le(i[r+1]));return new I(t)}function Qm(i,e){return i.map(t=>{if(w(t,Pi)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(w(t,wt)&&w(t.value,Pi)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}function k2(i){return typeof i=="object"&&i!==null&&E2 in i}var b2,Le,I,Wa,_2,S2,gZ,wt,Pi,E2,ct,De=S(()=>{A();Nl();ui();Ci();Ai();pi();bt();b2=class{static[v]="FakePrimitiveParam"};Le=class{static[v]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new I([this])}},I=class i{constructor(e){this.queryChunks=e}static[v]="SQL";decoder=_2;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return he.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:s,escapeParam:a,prepareTyping:o,inlineParams:c,paramStartIndex:l}=r;return nF(e.map(p=>{if(w(p,Le))return{sql:p.value.join(""),params:[]};if(w(p,Wa))return{sql:s(p.value),params:[]};if(p===void 0)return{sql:"",params:[]};if(Array.isArray(p)){let u=[new Le("(")];for(let[d,f]of p.entries())u.push(f),d<p.length-1&&u.push(new Le(", "));return u.push(new Le(")")),this.buildQueryFromSourceParams(u,r)}if(w(p,i))return this.buildQueryFromSourceParams(p.queryChunks,{...r,inlineParams:c||p.shouldInlineParams});if(w(p,O)){let u=p[O.Symbol.Schema],d=p[O.Symbol.Name];return{sql:u===void 0||p[Ga]?s(d):s(u)+"."+s(d),params:[]}}if(w(p,re)){let u=n.getColumnCasing(p);if(t.invokeSource==="indexes")return{sql:s(u),params:[]};let d=p.table[O.Symbol.Schema];return{sql:p.table[Ga]||d===void 0?s(p.table[O.Symbol.Name])+"."+s(u):s(d)+"."+s(p.table[O.Symbol.Name])+"."+s(u),params:[]}}if(w(p,ct)){let u=p[ge].schema,d=p[ge].name;return{sql:u===void 0||p[ge].isAlias?s(d):s(u)+"."+s(d),params:[]}}if(w(p,wt)){if(w(p.value,Pi))return{sql:a(l.value++,p),params:[p],typings:["none"]};let u=p.value===null?null:p.encoder.mapToDriverValue(p.value);if(w(u,i))return this.buildQueryFromSourceParams([u],r);if(c)return{sql:this.mapInlineParam(u,r),params:[]};let d=["none"];return o&&(d=[o(p.encoder)]),{sql:a(l.value++,u),params:[u],typings:d}}return w(p,Pi)?{sql:a(l.value++,p),params:[p],typings:["none"]}:w(p,i.Aliased)&&p.fieldAlias!==void 0?{sql:s(p.fieldAlias),params:[]}:w(p,Re)?p._.isWith?{sql:s(p._.alias),params:[]}:this.buildQueryFromSourceParams([new Le("("),p._.sql,new Le(") "),new Wa(p._.alias)],r):f2(p)?p.schema?{sql:s(p.schema)+"."+s(p.enumName),params:[]}:{sql:s(p.enumName),params:[]}:Hm(p)?p.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([p.getSQL()],r):this.buildQueryFromSourceParams([new Le("("),p.getSQL(),new Le(")")],r):c?{sql:this.mapInlineParam(p,r),params:[]}:{sql:a(l.value++,p),params:[p],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new i.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Wa=class{constructor(e){this.value=e}static[v]="Name";brand;getSQL(){return new I([this])}};_2={mapFromDriverValue:i=>i},S2={mapToDriverValue:i=>i},gZ={..._2,...S2},wt=class{constructor(e,t=S2){this.value=e,this.encoder=t}static[v]="Param";brand;getSQL(){return new I([this])}};(i=>{function e(){return new I([])}i.empty=e;function t(c){return new I(c)}i.fromList=t;function r(c){return new I([new Le(c)])}i.raw=r;function n(c,l){let p=[];for(let[u,d]of c.entries())u>0&&l!==void 0&&p.push(l),p.push(d);return new I(p)}i.join=n;function s(c){return new Wa(c)}i.identifier=s;function a(c){return new Pi(c)}i.placeholder=a;function o(c,l){return new wt(c,l)}i.param=o})(x||(x={}));(i=>{class e{constructor(r,n){this.sql=r,this.fieldAlias=n}static[v]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(I||(I={}));Pi=class{constructor(e){this.name=e}static[v]="Placeholder";getSQL(){return new I([this])}};E2=Symbol.for("drizzle:IsDrizzleView"),ct=class{static[v]="View";[ge];[E2]=!0;constructor({name:e,schema:t,selectedFields:r,query:n}){this[ge]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new I([this])}};re.prototype.getSQL=function(){return new I([this])};O.prototype.getSQL=function(){return new I([this])};Re.prototype.getSQL=function(){return new I([this])}});function Ka(i,e){return new Proxy(i,new us(e,!1))}function di(i,e){return new Proxy(i,new Dr(new Proxy(i.table,new us(e,!1))))}function Vm(i,e){return new I.Aliased(Za(i.sql,e),i.fieldAlias)}function Za(i,e){return x.join(i.queryChunks.map(t=>w(t,re)?di(t,e):w(t,I)?Za(t,e):w(t,I.Aliased)?Vm(t,e):t))}var Dr,us,T2,jl=S(()=>{pi();A();De();bt();Ai();Dr=class{constructor(e){this.table=e}static[v]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},us=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[v]="TableAliasProxyHandler";get(e,t){if(t===O.Symbol.IsAlias)return!0;if(t===O.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===O.Symbol.OriginalName)return this.alias;if(t===ge)return{...e[ge],name:this.alias,isAlias:!0};if(t===O.Symbol.Columns){let n=e[O.Symbol.Columns];if(!n)return n;let s={};return Object.keys(n).map(a=>{s[a]=new Proxy(n[a],new Dr(new Proxy(e,this)))}),s}let r=e[t];return w(r,re)?new Proxy(r,new Dr(new Proxy(e,this))):r}},T2=class{constructor(e){this.alias=e}static[v]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Ka(e.sourceTable,this.alias):e[t]}}});var pe,nr=S(()=>{jl();pi();A();De();ui();Ai();pe=class i{static[v]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ge)return{...e[ge],selectedFields:new Proxy(e[ge].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(w(e,Re)?e._.selectedFields:w(e,ct)?e[ge].selectedFields:e)[t];if(w(n,I.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let s=n.clone();return s.isSelectionField=!0,s}if(w(n,I)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return w(n,re)?this.config.alias?new Proxy(n,new Dr(new Proxy(n.table,new us(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new i(this.config))}}});function C2(i,e,t){let r={},n=i.reduce((s,{path:a,field:o},c)=>{let l;w(o,re)?l=o:w(o,I)?l=o.decoder:l=o.sql.decoder;let p=s;for(let[u,d]of a.entries())if(u<a.length-1)d in p||(p[d]={}),p=p[d];else{let f=e[c],m=p[d]=f===null?null:l.mapFromDriverValue(f);if(t&&w(o,re)&&a.length===2){let h=a[0];h in r?typeof r[h]=="string"&&r[h]!==yt(o.table)&&(r[h]=!1):r[h]=m===null?yt(o.table):!1}}return s},{});if(t&&Object.keys(r).length>0)for(let[s,a]of Object.entries(r))typeof a=="string"&&!t[a]&&(n[s]=null);return n}function zt(i,e){return Object.entries(i).reduce((t,[r,n])=>{if(typeof r!="string")return t;let s=e?[...e,r]:[r];return w(n,re)||w(n,I)||w(n,I.Aliased)?t.push({path:s,field:n}):w(n,O)?t.push(...zt(n[O.Symbol.Columns],s)):t.push(...zt(n,s)),t},[])}function Xa(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[n,s]of t.entries())if(s!==r[n])return!1;return!0}function ql(i,e){let t=Object.entries(e).filter(([,r])=>r!==void 0).map(([r,n])=>w(n,I)||w(n,re)?[r,n]:[r,new wt(n,i[O.Symbol.Columns][r])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function A2(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function Br(i){return i[O.Symbol.Columns]}function P2(i){return i[ge].selectedFields}function Ni(i){return w(i,Re)?i._.alias:w(i,ct)?i[ge].name:w(i,I)?void 0:i[O.Symbol.IsAlias]?i[O.Symbol.Name]:i[O.Symbol.BaseName]}function Y(i,e){return{name:typeof i=="string"&&i.length>0?i:"",config:typeof i=="object"?i:e}}function N2(i){if(typeof i!="object"||i===null||i.constructor.name!=="Object")return!1;if("logger"in i){let e=typeof i.logger;return!(e!=="boolean"&&(e!=="object"||typeof i.logger.logQuery!="function")&&e!=="undefined")}if("schema"in i){let e=typeof i.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in i){let e=typeof i.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in i)return!(i.mode!=="default"||i.mode!=="planetscale"||i.mode!==void 0);if("connection"in i){let e=typeof i.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in i){let e=typeof i.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(i).length===0}var ue=S(()=>{pi();A();De();ui();bt();Ai()});var Ja,O2=S(()=>{A();Ti();nr();bt();Ci();ue();Ja=class extends Je{constructor(e,t,r,n){super(),this.session=t,this.dialect=r,this.config={table:e,withList:n}}static[v]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[O.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=zt(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return he.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>he.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:yt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function sF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function aF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,r,n)=>{let s=n===0?r.toLowerCase():`${r[0].toUpperCase()}${r.slice(1)}`;return t+s},"")}function oF(i){return i}var Ml,I2=S(()=>{A();bt();Ml=class{static[v]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?sF:e==="camelCase"?aF:oF}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[O.Symbol.Schema]??"public",r=e.table[O.Symbol.OriginalName],n=`${t}.${r}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[O.Symbol.Schema]??"public",r=e[O.Symbol.OriginalName],n=`${t}.${r}`;if(!this.cachedTables[n]){for(let s of Object.values(e[O.Symbol.Columns])){let a=`${n}.${s.name}`;this.cache[a]=this.convert(s.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ya,Rl,Ll=S(()=>{A();Ya=class extends Error{static[v]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Rl=class extends Ya{static[v]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Oi,eo=S(()=>{A();Z();Oi=class extends M{static[v]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function j2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Gm(t):new Km(t)}var Gm,Wm,Km,Zm,Xm=S(()=>{A();ue();Z();eo();Gm=class extends Oi{static[v]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Wm(e,this.config)}},Wm=class extends C{static[v]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Km=class extends Oi{static[v]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Zm(e,this.config)}},Zm=class extends C{static[v]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function q2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Jm(t):new eh(t)}var Jm,Ym,eh,th,ih=S(()=>{A();ue();Z();Jm=class extends M{static[v]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ym(e,this.config)}},Ym=class extends C{static[v]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},eh=class extends M{static[v]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new th(e,this.config)}},th=class extends C{static[v]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function ds(i){return new rh(i??"")}var rh,nh,sh=S(()=>{A();Z();rh=class extends M{static[v]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new nh(e,this.config)}},nh=class extends C{static[v]="PgBoolean";getSQLType(){return"boolean"}}});function M2(i,e={}){let{name:t,config:r}=Y(i,e);return new ah(t,r)}var ah,oh,ch=S(()=>{A();ue();Z();ah=class extends M{static[v]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new oh(e,this.config)}},oh=class extends C{static[v]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function R2(i){return new lh(i??"")}var lh,ph,uh=S(()=>{A();Z();lh=class extends M{static[v]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new ph(e,this.config)}},ph=class extends C{static[v]="PgCidr";getSQLType(){return"cidr"}}});function L2(i){return(e,t)=>{let{name:r,config:n}=Y(e,t);return new dh(r,n,i)}}var dh,fh,mh=S(()=>{A();ue();Z();dh=class extends M{static[v]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new fh(e,this.config)}},fh=class extends C{static[v]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var fi,Dl=S(()=>{A();De();Z();fi=class extends M{static[v]="PgDateColumnBaseBuilder";defaultNow(){return this.default(x`now()`)}}});function D2(i,e){let{name:t,config:r}=Y(i,e);return r?.mode==="date"?new hh(t):new gh(t)}var hh,to,gh,io,vh=S(()=>{A();ue();Z();Dl();hh=class extends fi{static[v]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new to(e,this.config)}},to=class extends C{static[v]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},gh=class extends fi{static[v]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new io(e,this.config)}},io=class extends C{static[v]="PgDateString";getSQLType(){return"date"}}});function B2(i){return new xh(i??"")}var xh,yh,bh=S(()=>{A();Z();xh=class extends M{static[v]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new yh(e,this.config)}},yh=class extends C{static[v]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function z2(i){return new wh(i??"")}var wh,_h,Sh=S(()=>{A();Z();wh=class extends M{static[v]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new _h(e,this.config)}},_h=class extends C{static[v]="PgInet";getSQLType(){return"inet"}}});function Ft(i){return new Eh(i??"")}var Eh,kh,Th=S(()=>{A();Z();eo();Eh=class extends Oi{static[v]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new kh(e,this.config)}},kh=class extends C{static[v]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function F2(i,e={}){let{name:t,config:r}=Y(i,e);return new Ch(t,r)}var Ch,Ah,Ph=S(()=>{A();ue();Z();Ch=class extends M{static[v]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new Ah(e,this.config)}},Ah=class extends C{static[v]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}});function U2(i){return new Nh(i??"")}var Nh,ro,Oh=S(()=>{A();Z();Nh=class extends M{static[v]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ro(e,this.config)}},ro=class extends C{static[v]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function $2(i){return new Ih(i??"")}var Ih,no,jh=S(()=>{A();Z();Ih=class extends M{static[v]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new no(e,this.config)}},no=class extends C{static[v]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function H2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new qh(t):new Rh(t)}var qh,Mh,Rh,Lh,Dh=S(()=>{A();ue();Z();qh=class extends M{static[v]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Mh(e,this.config)}},Mh=class extends C{static[v]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Rh=class extends M{static[v]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Lh(e,this.config)}},Lh=class extends C{static[v]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function Q2(i){return new Bh(i??"")}var Bh,zh,Fh=S(()=>{A();Z();Bh=class extends M{static[v]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new zh(e,this.config)}},zh=class extends C{static[v]="PgMacaddr";getSQLType(){return"macaddr"}}});function V2(i){return new Uh(i??"")}var Uh,$h,Hh=S(()=>{A();Z();Uh=class extends M{static[v]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new $h(e,this.config)}},$h=class extends C{static[v]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function Vh(i,e){let{name:t,config:r}=Y(i,e);return new Qh(t,r?.precision,r?.scale)}var Qh,so,Xt,Gh=S(()=>{A();ue();Z();Qh=class extends M{static[v]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new so(e,this.config)}},so=class extends C{static[v]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Xt=Vh});function G2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new Wh(t):new Zh(t)}var Wh,Kh,Zh,Xh,Jh=S(()=>{A();ue();Z();Wh=class extends M{static[v]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Kh(e,this.config)}},Kh=class extends C{static[v]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Zh=class extends M{static[v]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new Xh(e,this.config)}},Xh=class extends C{static[v]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function cF(i){let e=[];for(let t=0;t<i.length;t+=2)e.push(Number.parseInt(i.slice(t,t+2),16));return new Uint8Array(e)}function W2(i,e){let t=new ArrayBuffer(8),r=new DataView(t);for(let n=0;n<8;n++)r.setUint8(n,i[e+n]);return r.getFloat64(0,!0)}function Yh(i){let e=cF(i),t=0,r=e[t];t+=1;let n=new DataView(e.buffer),s=n.getUint32(t,r===1);t+=4;let a;if(s&536870912&&(a=n.getUint32(t,r===1),t+=4),(s&65535)===1){let o=W2(e,t);t+=8;let c=W2(e,t);return t+=8,[o,c]}throw new Error("Unsupported geometry type")}var K2=S(()=>{});function Z2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new eg(t):new ig(t)}var eg,tg,ig,rg,ng=S(()=>{A();ue();Z();K2();eg=class extends M{static[v]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new tg(e,this.config)}},tg=class extends C{static[v]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Yh(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},ig=class extends M{static[v]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new rg(e,this.config)}},rg=class extends C{static[v]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=Yh(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function X2(i){return new sg(i??"")}var sg,ag,og=S(()=>{A();Z();sg=class extends M{static[v]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ag(e,this.config)}},ag=class extends C{static[v]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function mi(i){return new cg(i??"")}var cg,lg,pg=S(()=>{A();Z();cg=class extends M{static[v]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new lg(e,this.config)}},lg=class extends C{static[v]="PgSerial";getSQLType(){return"serial"}}});function J2(i){return new ug(i??"")}var ug,dg,fg=S(()=>{A();Z();eo();ug=class extends Oi{static[v]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new dg(e,this.config)}},dg=class extends C{static[v]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Y2(i){return new mg(i??"")}var mg,hg,gg=S(()=>{A();Z();mg=class extends M{static[v]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new hg(e,this.config)}},hg=class extends C{static[v]="PgSmallSerial";getSQLType(){return"smallserial"}}});function K(i,e={}){let{name:t,config:r}=Y(i,e);return new vg(t,r)}var vg,xg,yg=S(()=>{A();ue();Z();vg=class extends M{static[v]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new xg(e,this.config)}},xg=class extends C{static[v]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function eC(i,e={}){let{name:t,config:r}=Y(i,e);return new bg(t,r.withTimezone??!1,r.precision)}var bg,ao,wg=S(()=>{A();ue();Z();Dl();bg=class extends fi{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static[v]="PgTimeBuilder";build(e){return new ao(e,this.config)}},ao=class extends C{static[v]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function hi(i,e={}){let{name:t,config:r}=Y(i,e);return r?.mode==="string"?new Sg(t,r.withTimezone??!1,r.precision):new _g(t,r?.withTimezone??!1,r?.precision)}var _g,oo,Sg,co,Eg=S(()=>{A();ue();Z();Dl();_g=class extends fi{static[v]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new oo(e,this.config)}},oo=class extends C{static[v]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Sg=class extends fi{static[v]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new co(e,this.config)}},co=class extends C{static[v]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function tC(i){return new kg(i??"")}var kg,lo,Tg=S(()=>{A();De();Z();kg=class extends M{static[v]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(x`gen_random_uuid()`)}build(e){return new lo(e,this.config)}},lo=class extends C{static[v]="PgUUID";getSQLType(){return"uuid"}}});function iC(i,e={}){let{name:t,config:r}=Y(i,e);return new Cg(t,r)}var Cg,Ag,Pg=S(()=>{A();ue();Z();Cg=class extends M{static[v]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ag(e,this.config)}},Ag=class extends C{static[v]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function rC(i,e){let{name:t,config:r}=Y(i,e);return new Ng(t,r)}var Ng,Og,Ig=S(()=>{A();ue();Z();Ng=class extends M{static[v]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new Og(e,this.config)}},Og=class extends C{static[v]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function nC(i,e){let{name:t,config:r}=Y(i,e);return new jg(t,r)}var jg,qg,Mg=S(()=>{A();ue();Z();jg=class extends M{static[v]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new qg(e,this.config)}},qg=class extends C{static[v]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensio
==> Running 'npm run start'
> rest-express@1.0.0 start
> npm run db:push && node dist/index.js
> rest-express@1.0.0 db:push
> drizzle-kit push
No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/render/project/src/drizzle.config.ts'
Using 'pg' driver for database querying
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[✓] Pulling schema from database...
Is plain_password column in users table created or renamed from another column?
❯ + plain_password                    create column
  ~ kyc_document_url › plain_password rename column[2026-01-15 19:16:20] DEBUG Creating transport: nodemailer (7.0.12; +https://nodemailer.com/; SMTP (pool)/7.0.12[client:7.0.12])
7:16:20 PM [express] serving on port 10000
file:///opt/render/project/src/dist/index.js:71
`);Qa.write(UT.format.apply(UT,e))}}Object.defineProperty(ki.exports,"isWin",{get:function(){return vl},set:function(i){vl=i}});ki.exports.warnTo=function(i){var e=Qa;return Qa=i,e};ki.exports.getFileName=function(i){var e=i||process.env,t=e.PGPASSFILE||(vl?FT.join(e.APPDATA||"./","postgresql","pgpass.conf"):FT.join(e.HOME||"./",".pgpass"));return t};ki.exports.usePgPass=function(i,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:vl?!0:(e=e||"<unkn>",Az(i.mode)?i.mode&(Ez|kz)?(mm('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(mm('WARNING: password file "%s" is not a plain file',e),!1))};var Nz=ki.exports.match=function(i,e){return as.slice(0,-1).reduce(function(t,r,n){return n==1&&Number(i[r]||Sz)===Number(e[r])?t&&!0:t&&(e[r]==="*"||e[r]===i[r])},!0)};ki.exports.getPassword=function(i,e,t){var r,n=e.pipe(_z());function s(c){var l=Oz(c);l&&Iz(l)&&Nz(i,l)&&(r=l[Pz],n.end())}var a=function(){e.destroy(),t(r)},o=function(c){e.destroy(),mm("WARNING: error on reading file: %s",c),t(void 0)};e.on("error",o),n.on("data",s).on("end",a).on("error",o)};var Oz=ki.exports.parseLine=function(i){if(i.length<11||i.match(/^\s+#/))return null;for(var e="",t="",r=0,n=0,s=0,a={},o=!1,c=function(p,u,d){var f=i.substring(u,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(f=f.replace(/\\([:\\])/g,"$1")),a[as[p]]=f},l=0;l<i.length-1;l+=1){if(e=i.charAt(l+1),t=i.charAt(l),o=r==fm-1,o){c(r,n);break}l>=0&&e==":"&&t!=="\\"&&(c(r,n,l+1),n=l+2,r+=1)}return a=Object.keys(a).length===fm?a:null,a},Iz=ki.exports.isValidEntry=function(i){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<as.length;t+=1){var r=e[t],n=i[as[t]]||"",s=r(n);if(!s)return!1}return!0}});var QT=g((rK,hm)=>{"use strict";var iK=b("path"),HT=b("fs"),xl=$T();hm.exports=function(i,e){var t=xl.getFileName();HT.stat(t,function(r,n){if(r||!xl.usePgPass(n,t))return e(void 0);var s=HT.createReadStream(t);xl.getPassword(i,s,e)})};hm.exports.warnTo=xl.warnTo});var KT=g((nK,WT)=>{"use strict";var jz=b("events").EventEmitter,VT=ts(),gm=dT(),qz=pl(),Mz=Df(),GT=kT(),Rz=$a(),Lz=dm(),Dz=Mf(),yl=class extends jz{constructor(e){super(),this.connectionParameters=new Mz(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let t=e||{};this._Promise=t.Promise||global.Promise,this._types=new qz(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new Lz({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||Rz.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=r=>{process.nextTick(()=>{r.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){let t=this,r=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{r._ending=!0,r.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){t.ssl?r.requestSsl():r.startup(t.getStartupConf())}),r.on("sslconnect",function(){r.startup(t.getStartupConf())}),this._attachListeners(r),r.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,r)=>{this._connect(n=>{n?r(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(r=>{if(r!==void 0){if(typeof r!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=r}else this.connectionParameters.password=this.password=null;e()}).catch(r=>{t.emit("error",r)});else if(this.password!==null)e();else try{QT()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(r){this.emit("error",r)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await Dz.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=gm.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await gm.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{gm.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;return r&&(t.application_name=r),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){let r=this.connection;this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){r.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,r){return this._types.setTypeParser(e,t,r)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return VT.escapeIdentifier(e)}escapeLiteral(e){return VT.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,r){let n,s,a,o,c;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(a=e.query_timeout||this.connectionParameters.query_timeout,n=new GT(e,t,r),n.callback||(s=new this._Promise((l,p)=>{n.callback=(u,d)=>u?p(u):l(d)}).catch(l=>{throw Error.captureStackTrace(l),l}))),a&&(c=n.callback,o=setTimeout(()=>{let l=new Error("Query read timeout");process.nextTick(()=>{n.handleError(l,this.connection)}),c(l),n.callback=()=>{};let p=this.queryQueue.indexOf(n);p>-1&&this.queryQueue.splice(p,1),this._pulseQueryQueue()},a),n.callback=(l,p)=>{clearTimeout(o),c(l,p)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(n),this._pulseQueryQueue(),s):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};yl.Query=GT;WT.exports=yl});var YT=g((sK,JT)=>{"use strict";var Bz=b("events").EventEmitter,ZT=function(){},XT=(i,e)=>{let t=i.findIndex(e);return t===-1?void 0:i.splice(t,1)[0]},vm=class{constructor(e,t,r){this.client=e,this.idleListener=t,this.timeoutId=r}},os=class{constructor(e){this.callback=e}};function zz(){throw new Error("Release called on client which has already been released to the pool.")}function bl(i,e){if(e)return{callback:e,result:void 0};let t,r,n=function(a,o){a?t(a):r(o)},s=new i(function(a,o){r=a,t=o}).catch(a=>{throw Error.captureStackTrace(a),a});return{callback:n,result:s}}function Fz(i,e){return function t(r){r.client=e,e.removeListener("error",t),e.on("error",()=>{i.log("additional client error after disconnection due to error",r)}),i._remove(e),i.emit("error",r,e)}}var xm=class extends Bz{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||wl().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let r=t.client;r.ref&&r.ref();let n=t.idleListener;return this._acquireClient(r,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,t){let r=XT(this._idle,s=>s.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(s=>s!==e);let n=this;e.end(()=>{n.emit("remove",e),typeof t=="function"&&t()})}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=bl(this.Promise,e),r=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new os(t.callback)),r;let n=(o,c,l)=>{clearTimeout(a),t.callback(o,c,l)},s=new os(n),a=setTimeout(()=>{XT(this._pendingQueue,o=>o.callback===n),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return a.unref&&a.unref(),this._pendingQueue.push(s),r}return this.newClient(new os(t.callback)),r}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let r=Fz(this,t);this.log("checking client timeout");let n,s=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(n&&clearTimeout(n),t.on("error",r),a)this.log("client failed to connect",a),this._clients=this._clients.filter(o=>o!==t),s&&(a=new Error("Connection terminated due to connection timeout",{cause:a})),this._pulseQueue(),e.timedOut||e.callback(a,void 0,ZT);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(l=>l.client===t)!==-1&&this._acquireClient(t,new os((l,p,u)=>u()),r,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),t.once("end",()=>clearTimeout(o))}return this._acquireClient(t,e,r,!0)}})}_acquireClient(e,t,r,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,r),e.removeListener("error",r),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,ZT);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let r=!1;return n=>{r&&zz(),r=!0,this._release(e,t,n)}}_release(e,t,r){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",r,e),r||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let s;this.options.idleTimeoutMillis&&this._isAboveMin()&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new vm(e,t,s)),this._pulseQueue()}query(e,t,r){if(typeof e=="function"){let s=bl(this.Promise,e);return setImmediate(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(r=t,t=void 0);let n=bl(this.Promise,r);return r=n.callback,this.connect((s,a)=>{if(s)return r(s);let o=!1,c=l=>{o||(o=!0,a.release(l),r(l))};a.once("error",c),this.log("dispatching query");try{a.query(e,t,(l,p)=>{if(this.log("query dispatched"),a.removeListener("error",c),!o)return o=!0,a.release(l),l?r(l):r(void 0,p)})}catch(l){return a.release(l),r(l)}}),n.result}end(e){if(this.log("ending"),this.ending){let r=new Error("Called end on pool more than once");return e?e(r):this.Promise.reject(r)}this.ending=!0;let t=bl(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};JT.exports=xm});var i2=g((aK,t2)=>{"use strict";var e2=b("events").EventEmitter,Uz=b("util"),ym=ts(),cs=t2.exports=function(i,e,t){e2.call(this),i=ym.normalizeQueryConfig(i,e,t),this.text=i.text,this.values=i.values,this.name=i.name,this.queryMode=i.queryMode,this.callback=i.callback,this.state="new",this._arrayMode=i.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(r){r==="row"&&(this._emitRowEvents=!0)}.bind(this))};Uz.inherits(cs,e2);var $z={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};cs.prototype.handleError=function(i){let e=this.native.pq.resultErrorFields();if(e)for(let t in e){let r=$z[t]||t;i[r]=e[t]}this.callback?this.callback(i):this.emit("error",i),this.state="error"};cs.prototype.then=function(i,e){return this._getPromise().then(i,e)};cs.prototype.catch=function(i){return this._getPromise().catch(i)};cs.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(i,e){this._once("end",i),this._once("error",e)}.bind(this)),this._promise)};cs.prototype.submit=function(i){this.state="running";let e=this;this.native=i.native,i.native.arrayMode=this._arrayMode;let t=function(r,n,s){if(i.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),r)return e.handleError(r);e._emitRowEvents&&(s.length>1?n.forEach((a,o)=>{a.forEach(c=>{e.emit("row",c,s[o])})}):n.forEach(function(a){e.emit("row",a,s)})),e.state="end",e.emit("end",s),e.callback&&e.callback(null,s)};if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let r=(this.values||[]).map(ym.prepareValue);if(i.namedQueries[this.name]){if(this.text&&i.namedQueries[this.name]!==this.text){let n=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(n)}return i.native.execute(this.name,r,t)}return i.native.prepare(this.name,this.text,r.length,function(n){return n?t(n):(i.namedQueries[e.name]=e.text,e.native.execute(e.name,r,t))})}else if(this.values){if(!Array.isArray(this.values)){let n=new Error("Query values must be an array");return t(n)}let r=this.values.map(ym.prepareValue);i.native.query(this.text,r,t)}else this.queryMode==="extended"?i.native.query(this.text,[],t):i.native.query(this.text,t)}});var o2=g((oK,a2)=>{"use strict";var r2;try{r2=b("pg-native")}catch(i){throw i}var Hz=pl(),n2=b("events").EventEmitter,Qz=b("util"),Vz=Df(),s2=i2(),xt=a2.exports=function(i){n2.call(this),i=i||{},this._Promise=i.Promise||global.Promise,this._types=new Hz(i.types),this.native=new r2({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new Vz(i);i.nativeConnectionString&&(e.nativeConnectionString=i.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};xt.Query=s2;Qz.inherits(xt,n2);xt.prototype._errorAllQueries=function(i){let e=t=>{process.nextTick(()=>{t.native=this.native,t.handleError(i)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};xt.prototype._connect=function(i){let e=this;if(this._connecting){process.nextTick(()=>i(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,r){if(e.connectionParameters.nativeConnectionString&&(r=e.connectionParameters.nativeConnectionString),t)return i(t);e.native.connect(r,function(n){if(n)return e.native.end(),i(n);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),i()})})};xt.prototype.connect=function(i){if(i){this._connect(i);return}return new this._Promise((e,t)=>{this._connect(r=>{r?t(r):e()})})};xt.prototype.query=function(i,e,t){let r,n,s,a,o;if(i==null)throw new TypeError("Client was passed a null or undefined query");if(typeof i.submit=="function")s=i.query_timeout||this.connectionParameters.query_timeout,n=r=i,typeof e=="function"&&(i.callback=e);else if(s=i.query_timeout||this.connectionParameters.query_timeout,r=new s2(i,e,t),!r.callback){let c,l;n=new this._Promise((p,u)=>{c=p,l=u}).catch(p=>{throw Error.captureStackTrace(p),p}),r.callback=(p,u)=>p?l(p):c(u)}return s&&(o=r.callback,a=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),o(c),r.callback=()=>{};let l=this._queryQueue.indexOf(r);l>-1&&this._queryQueue.splice(l,1),this._pulseQueryQueue()},s),r.callback=(c,l)=>{clearTimeout(a),o(c,l)}),this._queryable?this._ending?(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(r),this._pulseQueryQueue(),n):(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};xt.prototype.end=function(i){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,i));let t;return i||(t=new this._Promise(function(r,n){i=s=>s?n(s):r()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),i&&i()})}),t};xt.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};xt.prototype._pulseQueryQueue=function(i){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){i||this.emit("drain");return}this._activeQuery=e,e.submit(this);let t=this;e.once("_done",function(){t._pulseQueryQueue()})};xt.prototype.cancel=function(i){this._activeQuery===i?this.native.cancel(function(){}):this._queryQueue.indexOf(i)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(i),1)};xt.prototype.ref=function(){};xt.prototype.unref=function(){};xt.prototype.setTypeParser=function(i,e,t){return this._types.setTypeParser(i,e,t)};xt.prototype.getTypeParser=function(i,e){return this._types.getTypeParser(i,e)}});var bm=g((cK,c2)=>{"use strict";c2.exports=o2()});var wl=g((pK,Va)=>{"use strict";var Gz=KT(),Wz=$a(),Kz=dm(),Zz=zf(),Xz=ts(),Jz=YT(),Yz=pl(),{DatabaseError:eF}=lm(),{escapeIdentifier:tF,escapeLiteral:iF}=ts(),rF=i=>class extends Jz{constructor(t){super(t,i)}},wm=function(i){this.defaults=Wz,this.Client=i,this.Query=this.Client.Query,this.Pool=rF(this.Client),this._pools=[],this.Connection=Kz,this.types=Ua(),this.DatabaseError=eF,this.TypeOverrides=Yz,this.escapeIdentifier=tF,this.escapeLiteral=iF,this.Result=Zz,this.utils=Xz};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Va.exports=new wm(bm()):(Va.exports=new wm(Gz),Object.defineProperty(Va.exports,"native",{configurable:!0,enumerable:!1,get(){let i=null;try{i=new wm(bm())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Va.exports,"native",{value:i}),i}}))});var At,uK,dK,fK,mK,hK,gK,vK,xK,yK,bK,wK,rr,_l=S(()=>{At=dt(wl(),1),uK=At.default.Client,dK=At.default.Pool,fK=At.default.Connection,mK=At.default.types,hK=At.default.Query,gK=At.default.DatabaseError,vK=At.default.escapeIdentifier,xK=At.default.escapeLiteral,yK=At.default.Result,bK=At.default.TypeOverrides,wK=At.default.defaults,rr=At.default});function w(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,v))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(i).constructor;if(t)for(;t;){if(v in t&&t[v]===e[v])return!0;t=Object.getPrototypeOf(t)}return!1}var v,SK,A=S(()=>{v=Symbol.for("drizzle:entityKind"),SK=Symbol.for("drizzle:hasOwnEntityKind")});var _m,Sl,El,kl=S(()=>{A();_m=class{static[v]="ConsoleLogWriter";write(e){console.log(e)}},Sl=class{static[v]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new _m}logQuery(e,t){let r=t.map(s=>{try{return JSON.stringify(s)}catch{return String(s)}}),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},El=class{static[v]="NoopLogger";logQuery(){}}});var Je,Ti=S(()=>{A();Je=class{static[v]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}});var re,pi=S(()=>{A();re=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[v]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Tl,Sm=S(()=>{A();Tl=class{static[v]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var Zt,Cl=S(()=>{Zt=Symbol.for("drizzle:Name")});var Al,Em,km=S(()=>{A();Cl();Al=class{static[v]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:n,foreignColumns:s}=e();return{name:r,columns:n,foreignTable:s[0].table,foreignColumns:s}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Em(e,this)}},Em=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[v]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(o=>o.name),s=r.map(o=>o.name),a=[this.table[Zt],...n,r[0].table[Zt],...s];return e??`${a.join("_")}_fk`}}});function Pl(i,...e){return i(...e)}var Tm=S(()=>{});function Pm(i,e){return`${i[Zt]}_${e.join("_")}_unique`}var Cm,l2,Am,Nm=S(()=>{A();Cl();Cm=class{constructor(e,t){this.name=t,this.columns=e}static[v]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Am(e,this.columns,this.nullsNotDistinctConfig,this.name)}},l2=class{static[v]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new Cm(e,this.name)}},Am=class{constructor(e,t,r,n){this.table=e,this.columns=t,this.name=n??Pm(this.table,this.columns.map(s=>s.name)),this.nullsNotDistinct=r}static[v]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function p2(i,e,t){for(let r=e;r<i.length;r++){let n=i[r];if(n==="\\"){r++;continue}if(n==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(n===","||n==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function u2(i,e=0){let t=[],r=e,n=!1;for(;r<i.length;){let s=i[r];if(s===","){(n||r===e)&&t.push(""),n=!0,r++;continue}if(n=!1,s==="\\"){r+=2;continue}if(s==='"'){let[c,l]=p2(i,r+1,!0);t.push(c),r=l;continue}if(s==="}")return[t,r+1];if(s==="{"){let[c,l]=u2(i,r+1);t.push(c),r=l;continue}let[a,o]=p2(i,r,!1);t.push(a),r=o}return[t,r]}function d2(i){let[e]=u2(i,1);return e}function Om(i){return`{${i.map(e=>Array.isArray(e)?Om(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Im=S(()=>{});var M,C,jm,ls,qm,Mm,Z=S(()=>{Sm();pi();A();km();Tm();Nm();Im();M=class extends Tl{foreignKeyConfigs=[];static[v]="PgColumnBuilder";array(e){return new qm(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>Pl((s,a)=>{let o=new Al(()=>{let c=s();return{columns:[e],foreignColumns:[c]}});return a.onUpdate&&o.onUpdate(a.onUpdate),a.onDelete&&o.onDelete(a.onDelete),o.build(t)},r,n))}buildExtraConfigColumn(e){return new jm(e,this.config)}},C=class extends re{constructor(e,t){t.uniqueName||(t.uniqueName=Pm(e,[t.name])),super(e,t),this.table=e}static[v]="PgColumn"},jm=class extends C{static[v]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},ls=class{static[v]="IndexedColumn";constructor(e,t,r,n){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=n}name;keyAsName;type;indexConfig},qm=class extends M{static[v]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new Mm(e,this.config,t)}},Mm=class i extends C{constructor(e,t,r,n){super(e,t),this.baseColumn=r,this.range=n,this.size=t.size}size;static[v]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=d2(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(n=>n===null?null:w(this.baseColumn,i)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?r:Om(r)}}});function f2(i){return!!i&&typeof i=="function"&&Rm in i&&i[Rm]===!0}function m2(i,e,t){let r=Object.assign(n=>new Lm(n??"",r),{enumName:i,enumValues:e,schema:t,[Rm]:!0});return r}var Rm,Lm,Dm,Nl=S(()=>{A();Z();Rm=Symbol.for("drizzle:isPgEnum");Lm=class extends M{static[v]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Dm(e,this.config)}},Dm=class extends C{static[v]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}});var Re,ps,ui=S(()=>{A();Re=class{static[v]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}},ps=class extends Re{static[v]="WithSubquery"}});var h2,g2=S(()=>{h2="0.39.3"});var Bm,zm,he,Ci=S(()=>{Tm();g2();he={startActiveSpan(i,e){return Bm?(zm||(zm=Bm.trace.getTracer("drizzle-orm",h2)),Pl((t,r)=>r.startActiveSpan(i,n=>{try{return e(n)}catch(s){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:s instanceof Error?s.message:"Unknown error"}),s}finally{n.end()}}),Bm,zm)):e()}}});var ge,Ai=S(()=>{ge=Symbol.for("drizzle:ViewBaseConfig")});function $m(i){return typeof i=="object"&&i!==null&&y2 in i}function yt(i){return i[Zt]}function Lr(i){return`${i[Ol]??"public"}.${i[Zt]}`}var Ol,Il,v2,Fm,Um,Ga,x2,y2,O,bt=S(()=>{A();Cl();Ol=Symbol.for("drizzle:Schema"),Il=Symbol.for("drizzle:Columns"),v2=Symbol.for("drizzle:ExtraConfigColumns"),Fm=Symbol.for("drizzle:OriginalName"),Um=Symbol.for("drizzle:BaseName"),Ga=Symbol.for("drizzle:IsAlias"),x2=Symbol.for("drizzle:ExtraConfigBuilder"),y2=Symbol.for("drizzle:IsDrizzleTable"),O=class{static[v]="Table";static Symbol={Name:Zt,Schema:Ol,OriginalName:Fm,Columns:Il,ExtraConfigColumns:v2,BaseName:Um,IsAlias:Ga,ExtraConfigBuilder:x2};[Zt];[Fm];[Ol];[Il];[v2];[Um];[Ga]=!1;[y2]=!0;[x2]=void 0;constructor(e,t,r){this[Zt]=this[Fm]=e,this[Ol]=t,this[Um]=r}}});function Hm(i){return i!=null&&typeof i.getSQL=="function"}function nF(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}function w2(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}function x(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new Le(i[0]));for(let[r,n]of e.entries())t.push(n,new Le(i[r+1]));return new I(t)}function Qm(i,e){return i.map(t=>{if(w(t,Pi)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(w(t,wt)&&w(t.value,Pi)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}function k2(i){return typeof i=="object"&&i!==null&&E2 in i}var b2,Le,I,Wa,_2,S2,gZ,wt,Pi,E2,ct,De=S(()=>{A();Nl();ui();Ci();Ai();pi();bt();b2=class{static[v]="FakePrimitiveParam"};Le=class{static[v]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new I([this])}},I=class i{constructor(e){this.queryChunks=e}static[v]="SQL";decoder=_2;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return he.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:s,escapeParam:a,prepareTyping:o,inlineParams:c,paramStartIndex:l}=r;return nF(e.map(p=>{if(w(p,Le))return{sql:p.value.join(""),params:[]};if(w(p,Wa))return{sql:s(p.value),params:[]};if(p===void 0)return{sql:"",params:[]};if(Array.isArray(p)){let u=[new Le("(")];for(let[d,f]of p.entries())u.push(f),d<p.length-1&&u.push(new Le(", "));return u.push(new Le(")")),this.buildQueryFromSourceParams(u,r)}if(w(p,i))return this.buildQueryFromSourceParams(p.queryChunks,{...r,inlineParams:c||p.shouldInlineParams});if(w(p,O)){let u=p[O.Symbol.Schema],d=p[O.Symbol.Name];return{sql:u===void 0||p[Ga]?s(d):s(u)+"."+s(d),params:[]}}if(w(p,re)){let u=n.getColumnCasing(p);if(t.invokeSource==="indexes")return{sql:s(u),params:[]};let d=p.table[O.Symbol.Schema];return{sql:p.table[Ga]||d===void 0?s(p.table[O.Symbol.Name])+"."+s(u):s(d)+"."+s(p.table[O.Symbol.Name])+"."+s(u),params:[]}}if(w(p,ct)){let u=p[ge].schema,d=p[ge].name;return{sql:u===void 0||p[ge].isAlias?s(d):s(u)+"."+s(d),params:[]}}if(w(p,wt)){if(w(p.value,Pi))return{sql:a(l.value++,p),params:[p],typings:["none"]};let u=p.value===null?null:p.encoder.mapToDriverValue(p.value);if(w(u,i))return this.buildQueryFromSourceParams([u],r);if(c)return{sql:this.mapInlineParam(u,r),params:[]};let d=["none"];return o&&(d=[o(p.encoder)]),{sql:a(l.value++,u),params:[u],typings:d}}return w(p,Pi)?{sql:a(l.value++,p),params:[p],typings:["none"]}:w(p,i.Aliased)&&p.fieldAlias!==void 0?{sql:s(p.fieldAlias),params:[]}:w(p,Re)?p._.isWith?{sql:s(p._.alias),params:[]}:this.buildQueryFromSourceParams([new Le("("),p._.sql,new Le(") "),new Wa(p._.alias)],r):f2(p)?p.schema?{sql:s(p.schema)+"."+s(p.enumName),params:[]}:{sql:s(p.enumName),params:[]}:Hm(p)?p.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([p.getSQL()],r):this.buildQueryFromSourceParams([new Le("("),p.getSQL(),new Le(")")],r):c?{sql:this.mapInlineParam(p,r),params:[]}:{sql:a(l.value++,p),params:[p],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new i.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Wa=class{constructor(e){this.value=e}static[v]="Name";brand;getSQL(){return new I([this])}};_2={mapFromDriverValue:i=>i},S2={mapToDriverValue:i=>i},gZ={..._2,...S2},wt=class{constructor(e,t=S2){this.value=e,this.encoder=t}static[v]="Param";brand;getSQL(){return new I([this])}};(i=>{function e(){return new I([])}i.empty=e;function t(c){return new I(c)}i.fromList=t;function r(c){return new I([new Le(c)])}i.raw=r;function n(c,l){let p=[];for(let[u,d]of c.entries())u>0&&l!==void 0&&p.push(l),p.push(d);return new I(p)}i.join=n;function s(c){return new Wa(c)}i.identifier=s;function a(c){return new Pi(c)}i.placeholder=a;function o(c,l){return new wt(c,l)}i.param=o})(x||(x={}));(i=>{class e{constructor(r,n){this.sql=r,this.fieldAlias=n}static[v]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(I||(I={}));Pi=class{constructor(e){this.name=e}static[v]="Placeholder";getSQL(){return new I([this])}};E2=Symbol.for("drizzle:IsDrizzleView"),ct=class{static[v]="View";[ge];[E2]=!0;constructor({name:e,schema:t,selectedFields:r,query:n}){this[ge]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new I([this])}};re.prototype.getSQL=function(){return new I([this])};O.prototype.getSQL=function(){return new I([this])};Re.prototype.getSQL=function(){return new I([this])}});function Ka(i,e){return new Proxy(i,new us(e,!1))}function di(i,e){return new Proxy(i,new Dr(new Proxy(i.table,new us(e,!1))))}function Vm(i,e){return new I.Aliased(Za(i.sql,e),i.fieldAlias)}function Za(i,e){return x.join(i.queryChunks.map(t=>w(t,re)?di(t,e):w(t,I)?Za(t,e):w(t,I.Aliased)?Vm(t,e):t))}var Dr,us,T2,jl=S(()=>{pi();A();De();bt();Ai();Dr=class{constructor(e){this.table=e}static[v]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},us=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[v]="TableAliasProxyHandler";get(e,t){if(t===O.Symbol.IsAlias)return!0;if(t===O.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===O.Symbol.OriginalName)return this.alias;if(t===ge)return{...e[ge],name:this.alias,isAlias:!0};if(t===O.Symbol.Columns){let n=e[O.Symbol.Columns];if(!n)return n;let s={};return Object.keys(n).map(a=>{s[a]=new Proxy(n[a],new Dr(new Proxy(e,this)))}),s}let r=e[t];return w(r,re)?new Proxy(r,new Dr(new Proxy(e,this))):r}},T2=class{constructor(e){this.alias=e}static[v]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Ka(e.sourceTable,this.alias):e[t]}}});var pe,nr=S(()=>{jl();pi();A();De();ui();Ai();pe=class i{static[v]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ge)return{...e[ge],selectedFields:new Proxy(e[ge].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(w(e,Re)?e._.selectedFields:w(e,ct)?e[ge].selectedFields:e)[t];if(w(n,I.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let s=n.clone();return s.isSelectionField=!0,s}if(w(n,I)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return w(n,re)?this.config.alias?new Proxy(n,new Dr(new Proxy(n.table,new us(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new i(this.config))}}});function C2(i,e,t){let r={},n=i.reduce((s,{path:a,field:o},c)=>{let l;w(o,re)?l=o:w(o,I)?l=o.decoder:l=o.sql.decoder;let p=s;for(let[u,d]of a.entries())if(u<a.length-1)d in p||(p[d]={}),p=p[d];else{let f=e[c],m=p[d]=f===null?null:l.mapFromDriverValue(f);if(t&&w(o,re)&&a.length===2){let h=a[0];h in r?typeof r[h]=="string"&&r[h]!==yt(o.table)&&(r[h]=!1):r[h]=m===null?yt(o.table):!1}}return s},{});if(t&&Object.keys(r).length>0)for(let[s,a]of Object.entries(r))typeof a=="string"&&!t[a]&&(n[s]=null);return n}function zt(i,e){return Object.entries(i).reduce((t,[r,n])=>{if(typeof r!="string")return t;let s=e?[...e,r]:[r];return w(n,re)||w(n,I)||w(n,I.Aliased)?t.push({path:s,field:n}):w(n,O)?t.push(...zt(n[O.Symbol.Columns],s)):t.push(...zt(n,s)),t},[])}function Xa(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[n,s]of t.entries())if(s!==r[n])return!1;return!0}function ql(i,e){let t=Object.entries(e).filter(([,r])=>r!==void 0).map(([r,n])=>w(n,I)||w(n,re)?[r,n]:[r,new wt(n,i[O.Symbol.Columns][r])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function A2(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function Br(i){return i[O.Symbol.Columns]}function P2(i){return i[ge].selectedFields}function Ni(i){return w(i,Re)?i._.alias:w(i,ct)?i[ge].name:w(i,I)?void 0:i[O.Symbol.IsAlias]?i[O.Symbol.Name]:i[O.Symbol.BaseName]}function Y(i,e){return{name:typeof i=="string"&&i.length>0?i:"",config:typeof i=="object"?i:e}}function N2(i){if(typeof i!="object"||i===null||i.constructor.name!=="Object")return!1;if("logger"in i){let e=typeof i.logger;return!(e!=="boolean"&&(e!=="object"||typeof i.logger.logQuery!="function")&&e!=="undefined")}if("schema"in i){let e=typeof i.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in i){let e=typeof i.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in i)return!(i.mode!=="default"||i.mode!=="planetscale"||i.mode!==void 0);if("connection"in i){let e=typeof i.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in i){let e=typeof i.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(i).length===0}var ue=S(()=>{pi();A();De();ui();bt();Ai()});var Ja,O2=S(()=>{A();Ti();nr();bt();Ci();ue();Ja=class extends Je{constructor(e,t,r,n){super(),this.session=t,this.dialect=r,this.config={table:e,withList:n}}static[v]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[O.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=zt(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return he.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>he.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:yt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function sF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function aF(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,r,n)=>{let s=n===0?r.toLowerCase():`${r[0].toUpperCase()}${r.slice(1)}`;return t+s},"")}function oF(i){return i}var Ml,I2=S(()=>{A();bt();Ml=class{static[v]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?sF:e==="camelCase"?aF:oF}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[O.Symbol.Schema]??"public",r=e.table[O.Symbol.OriginalName],n=`${t}.${r}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[O.Symbol.Schema]??"public",r=e[O.Symbol.OriginalName],n=`${t}.${r}`;if(!this.cachedTables[n]){for(let s of Object.values(e[O.Symbol.Columns])){let a=`${n}.${s.name}`;this.cache[a]=this.convert(s.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ya,Rl,Ll=S(()=>{A();Ya=class extends Error{static[v]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Rl=class extends Ya{static[v]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Oi,eo=S(()=>{A();Z();Oi=class extends M{static[v]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function j2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Gm(t):new Km(t)}var Gm,Wm,Km,Zm,Xm=S(()=>{A();ue();Z();eo();Gm=class extends Oi{static[v]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Wm(e,this.config)}},Wm=class extends C{static[v]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Km=class extends Oi{static[v]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Zm(e,this.config)}},Zm=class extends C{static[v]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function q2(i,e){let{name:t,config:r}=Y(i,e);return r.mode==="number"?new Jm(t):new eh(t)}var Jm,Ym,eh,th,ih=S(()=>{A();ue();Z();Jm=class extends M{static[v]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ym(e,this.config)}},Ym=class extends C{static[v]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},eh=class extends M{static[v]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new th(e,this.config)}},th=class extends C{static[v]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function ds(i){return new rh(i??"")}var rh,nh,sh=S(()=>{A();Z();rh=class extends M{static[v]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new nh(e,this.config)}},nh=class extends C{static[v]="PgBoolean";getSQLType(){return"boolean"}}});function M2(i,e={}){let{name:t,config:r}=Y(i,e);return new ah(t,r)}var ah,oh,ch=S(()=>{A();ue();Z();ah=class extends M{static[v]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new oh(e,this.config)}},oh=class extends C{static[v]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function R2(i){return new lh(i??"")}var lh,ph,uh=S(()=>{A();Z();lh=class extends M{static[v]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new ph(e,this.config)}},ph=class extends C{static[v]="PgCidr";getSQLType(){return"cidr"}}});function L2(i){return(e,t)=>{let{name:r,config:n}=Y(e,t);return new dh(r,n,i)}}var dh,fh,mh=S(()=>{A();ue();Z();dh=class extends M{static[v]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new fh(e,this.config)}},fh=class extends C{static[v]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var fi,Dl=S(()=>{A();De();Z();fi=class extends M{static[v]="PgDateColumnBaseBuilder";defaultNow(){return this.default(x`now()`)}}});function D2(i,e){let{name:t,config:r}=Y(i,e);return r?.mode==="date"?new hh(t):new gh(t)}var hh,to,gh,io,vh=S(()=>{A();ue();Z();Dl();hh=class extends fi{static[v]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new to(e,this.config)}},to=class extends C{static[v]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},gh=class extends fi{static[v]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new io(e,this.config)}},io=class extends C{static[v]="PgDateString";getSQLType(){return"date"}}});function B2(i){return new xh(i??"")}var xh,yh,bh=S(()=>{A();Z();xh=class extends M{static[v]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new yh(e,this.config)}},yh=class extends C{static[v]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function z2(i){return new wh(i??"")}var wh,_h,Sh=S(()=>{A();Z();wh=class extends M{static[v]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new _h(e,this.config)}},_h=class extends C{static[v]="PgInet";getSQLType(){return"inet"}}});function Ft(i){return new Eh(i??"")}var Eh,kh,Th=S(()=>{A();Z();eo();Eh=class extends Oi{static[v]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new kh(e,this.config)}},kh=class extends C{static[v]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function F2(i,e={}){let{name:t,config:r}=Y(i,e);return new Ch(t,r)}var Ch,Ah,Ph=S(()=>{A();ue();Z();Ch=class extends M{static[v]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new Ah(e,this.config)}},Ah=class extends C{static[v]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}});function U2(i){return new Nh(i??"")}var Nh,ro,Oh=S(()=>{A();Z();Nh=class extends M{static[v]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ro(e,this.config)}},ro=class extends C{static[v]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function $2(i){return new Ih(i??"")}var Ih,no,jh=S(()=>{A();Z();Ih=class extends M{static[v]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new no(e,this.config)}},no=class extends C{static[v]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function H2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new qh(t):new Rh(t)}var qh,Mh,Rh,Lh,Dh=S(()=>{A();ue();Z();qh=class extends M{static[v]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Mh(e,this.config)}},Mh=class extends C{static[v]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Rh=class extends M{static[v]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Lh(e,this.config)}},Lh=class extends C{static[v]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function Q2(i){return new Bh(i??"")}var Bh,zh,Fh=S(()=>{A();Z();Bh=class extends M{static[v]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new zh(e,this.config)}},zh=class extends C{static[v]="PgMacaddr";getSQLType(){return"macaddr"}}});function V2(i){return new Uh(i??"")}var Uh,$h,Hh=S(()=>{A();Z();Uh=class extends M{static[v]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new $h(e,this.config)}},$h=class extends C{static[v]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function Vh(i,e){let{name:t,config:r}=Y(i,e);return new Qh(t,r?.precision,r?.scale)}var Qh,so,Xt,Gh=S(()=>{A();ue();Z();Qh=class extends M{static[v]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new so(e,this.config)}},so=class extends C{static[v]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Xt=Vh});function G2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new Wh(t):new Zh(t)}var Wh,Kh,Zh,Xh,Jh=S(()=>{A();ue();Z();Wh=class extends M{static[v]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Kh(e,this.config)}},Kh=class extends C{static[v]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Zh=class extends M{static[v]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new Xh(e,this.config)}},Xh=class extends C{static[v]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function cF(i){let e=[];for(let t=0;t<i.length;t+=2)e.push(Number.parseInt(i.slice(t,t+2),16));return new Uint8Array(e)}function W2(i,e){let t=new ArrayBuffer(8),r=new DataView(t);for(let n=0;n<8;n++)r.setUint8(n,i[e+n]);return r.getFloat64(0,!0)}function Yh(i){let e=cF(i),t=0,r=e[t];t+=1;let n=new DataView(e.buffer),s=n.getUint32(t,r===1);t+=4;let a;if(s&536870912&&(a=n.getUint32(t,r===1),t+=4),(s&65535)===1){let o=W2(e,t);t+=8;let c=W2(e,t);return t+=8,[o,c]}throw new Error("Unsupported geometry type")}var K2=S(()=>{});function Z2(i,e){let{name:t,config:r}=Y(i,e);return!r?.mode||r.mode==="tuple"?new eg(t):new ig(t)}var eg,tg,ig,rg,ng=S(()=>{A();ue();Z();K2();eg=class extends M{static[v]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new tg(e,this.config)}},tg=class extends C{static[v]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Yh(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},ig=class extends M{static[v]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new rg(e,this.config)}},rg=class extends C{static[v]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=Yh(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function X2(i){return new sg(i??"")}var sg,ag,og=S(()=>{A();Z();sg=class extends M{static[v]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ag(e,this.config)}},ag=class extends C{static[v]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function mi(i){return new cg(i??"")}var cg,lg,pg=S(()=>{A();Z();cg=class extends M{static[v]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new lg(e,this.config)}},lg=class extends C{static[v]="PgSerial";getSQLType(){return"serial"}}});function J2(i){return new ug(i??"")}var ug,dg,fg=S(()=>{A();Z();eo();ug=class extends Oi{static[v]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new dg(e,this.config)}},dg=class extends C{static[v]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Y2(i){return new mg(i??"")}var mg,hg,gg=S(()=>{A();Z();mg=class extends M{static[v]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new hg(e,this.config)}},hg=class extends C{static[v]="PgSmallSerial";getSQLType(){return"smallserial"}}});function K(i,e={}){let{name:t,config:r}=Y(i,e);return new vg(t,r)}var vg,xg,yg=S(()=>{A();ue();Z();vg=class extends M{static[v]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new xg(e,this.config)}},xg=class extends C{static[v]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function eC(i,e={}){let{name:t,config:r}=Y(i,e);return new bg(t,r.withTimezone??!1,r.precision)}var bg,ao,wg=S(()=>{A();ue();Z();Dl();bg=class extends fi{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static[v]="PgTimeBuilder";build(e){return new ao(e,this.config)}},ao=class extends C{static[v]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function hi(i,e={}){let{name:t,config:r}=Y(i,e);return r?.mode==="string"?new Sg(t,r.withTimezone??!1,r.precision):new _g(t,r?.withTimezone??!1,r?.precision)}var _g,oo,Sg,co,Eg=S(()=>{A();ue();Z();Dl();_g=class extends fi{static[v]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new oo(e,this.config)}},oo=class extends C{static[v]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Sg=class extends fi{static[v]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new co(e,this.config)}},co=class extends C{static[v]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function tC(i){return new kg(i??"")}var kg,lo,Tg=S(()=>{A();De();Z();kg=class extends M{static[v]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(x`gen_random_uuid()`)}build(e){return new lo(e,this.config)}},lo=class extends C{static[v]="PgUUID";getSQLType(){return"uuid"}}});function iC(i,e={}){let{name:t,config:r}=Y(i,e);return new Cg(t,r)}var Cg,Ag,Pg=S(()=>{A();ue();Z();Cg=class extends M{static[v]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ag(e,this.config)}},Ag=class extends C{static[v]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function rC(i,e){let{name:t,config:r}=Y(i,e);return new Ng(t,r)}var Ng,Og,Ig=S(()=>{A();ue();Z();Ng=class extends M{static[v]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new Og(e,this.config)}},Og=class extends C{static[v]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function nC(i,e){let{name:t,config:r}=Y(i,e);return new jg(t,r)}var jg,qg,Mg=S(()=>{A();ue();Z();jg=class extends M{static[v]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new qg(e,this.config)}},qg=class extends C{static[v]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}}});function sC(i,e){let{name:t,config:r}=Y(i,e);return new Rg(t,r)}var Rg,Lg,Dg=S(()=>{A();ue();Z();Rg=class extends M{static[v]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new Lg(e,this.config)}},Lg=class extends C{static[v]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}});function aC(i,e){let{name:t,config:r}=Y(i,e);return new Bg(t,r)}var Bg,zg,Fg=S(()=>{A();ue();Z();Bg=class extends M{static[v]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new zg(e,this.config)}},zg=class extends C{static[v]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}}});var Bl=S(()=>{Xm();ih();sh();ch();uh();Z();mh();vh();bh();Nl();Sh();eo();Th();Ph();Oh();jh();Dh();Fh();Hh();Gh();Jh();ng();og();pg();fg();gg();yg();wg();Eg();Tg();Pg();Ig();Mg();Dg();Fg()});function oC(){return{bigint:j2,bigserial:q2,boolean:ds,char:M2,cidr:R2,customType:L2,date:D2,doublePrecision:B2,inet:z2,integer:Ft,interval:F2,json:U2,jsonb:$2,line:H2,macaddr:Q2,macaddr8:V2,numeric:Vh,point:G2,geometry:Z2,real:X2,serial:mi,smallint:J2,smallserial:Y2,text:K,time:eC,timestamp:hi,uuid:tC,varchar:iC,bit:rC,halfvec:nC,sparsevec:sC,vector:aC}}var cC=S(()=>{Xm();ih();sh();ch();uh();mh();vh();bh();Sh();Th();Ph();Oh();jh();Dh();Fh();Hh();Gh();Jh();ng();og();pg();fg();gg();yg();wg();Eg();Tg();Pg();Ig();Mg();Dg();Fg()});function $g(i,e,t,r,n=i){let s=new Ge(i,r,n),a=typeof e=="function"?e(oC()):e,o=Object.fromEntries(Object.entries(a).map(([p,u])=>{let d=u;d.setName(p);let f=d.build(s);return s[Ug].push(...d.buildForeignKeys(f,s)),[p,f]})),c=Object.fromEntries(Object.entries(a).map(([p,u])=>{let d=u;d.setName(p);let f=d.buildExtraConfigColumn(s);return[p,f]})),l=Object.assign(s,o);return l[O.Symbol.Columns]=o,l[O.Symbol.ExtraConfigColumns]=c,t&&(l[Ge.Symbol.ExtraConfigBuilder]=t),Object.assign(l,{enableRLS:()=>(l[Ge.Symbol.EnableRLS]=!0,l)})}var Ug,lC,Ge,Ut,zr=S(()=>{A();bt();cC();Ug=Symbol.for("drizzle:PgInlineForeignKeys"),lC=Symbol.for("drizzle:EnableRLS"),Ge=class extends O{static[v]="PgTable";static Symbol=Object.assign({},O.Symbol,{InlineForeignKeys:Ug,EnableRLS:lC});[Ug]=[];[lC]=!1;[O.Symbol.ExtraConfigBuilder]=void 0};Ut=(i,e,t)=>$g(i,e,t,void 0)});var zl,Hg,Qg=S(()=>{A();zr();zl=class{static[v]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new Hg(e,this.columns,this.name)}},Hg=class{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static[v]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[Ge.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}});function _t(i,e){return w2(e)&&!Hm(i)&&!w(i,wt)&&!w(i,Pi)&&!w(i,re)&&!w(i,O)&&!w(i,ct)?new wt(i,e):i}function po(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new I(e):new I([new Le("("),x.join(e,new Le(" and ")),new Le(")")])}function uC(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new I(e):new I([new Le("("),x.join(e,new Le(" or ")),new Le(")")])}function dC(i){return x`not ${i}`}function vC(i,e){return Array.isArray(e)?e.length===0?x`false`:x`${i} in ${e.map(t=>_t(t,i))}`:x`${i} in ${_t(e,i)}`}function xC(i,e){return Array.isArray(e)?e.length===0?x`true`:x`${i} not in ${e.map(t=>_t(t,i))}`:x`${i} not in ${_t(e,i)}`}function yC(i){return x`${i} is null`}function bC(i){return x`${i} is not null`}function wC(i){return x`exists ${i}`}function _C(i){return x`not exists ${i}`}function SC(i,e,t){return x`${i} between ${_t(e,i)} and ${_t(t,i)}`}function EC(i,e,t){return x`${i} not between ${_t(e,i)} and ${_t(t,i)}`}function kC(i,e){return x`${i} like ${e}`}function TC(i,e){return x`${i} not like ${e}`}function CC(i,e){return x`${i} ilike ${e}`}function AC(i,e){return x`${i} not ilike ${e}`}var de,pC,fC,mC,hC,gC,PC=S(()=>{pi();A();bt();De();de=(i,e)=>x`${i} = ${_t(e,i)}`,pC=(i,e)=>x`${i} <> ${_t(e,i)}`;fC=(i,e)=>x`${i} > ${_t(e,i)}`,mC=(i,e)=>x`${i} >= ${_t(e,i)}`,hC=(i,e)=>x`${i} < ${_t(e,i)}`,gC=(i,e)=>x`${i} <= ${_t(e,i)}`});function NC(i){return x`${i} asc`}function Ii(i){return x`${i} desc`}var OC=S(()=>{De()});var Fl=S(()=>{PC();OC()});function IC(){return{and:po,between:SC,eq:de,exists:wC,gt:fC,gte:mC,ilike:CC,inArray:vC,isNull:yC,isNotNull:bC,like:kC,lt:hC,lte:gC,ne:pC,not:dC,notBetween:EC,notExists:_C,notLike:TC,notIlike:AC,notInArray:xC,or:uC,sql:x}}function jC(){return{sql:x,asc:NC,desc:Ii}}function qC(i,e){Object.keys(i).length===1&&"default"in i&&!w(i.default,O)&&(i=i.default);let t={},r={},n={};for(let[s,a]of Object.entries(i))if(w(a,O)){let o=Lr(a),c=r[o];t[o]=s,n[s]={tsName:s,dbName:a[O.Symbol.Name],schema:a[O.Symbol.Schema],columns:a[O.Symbol.Columns],relations:c?.relations??{},primaryKey:c?.primaryKey??[]};for(let p of Object.values(a[O.Symbol.Columns]))p.primary&&n[s].primaryKey.push(p);let l=a[O.Symbol.ExtraConfigBuilder]?.(a[O.Symbol.ExtraConfigColumns]);if(l)for(let p of Object.values(l))w(p,zl)&&n[s].primaryKey.push(...p.columns)}else if(w(a,$l)){let o=Lr(a.table),c=t[o],l=a.config(e(a.table)),p;for(let[u,d]of Object.entries(l))if(c){let f=n[c];f.relations[u]=d,p&&f.primaryKey.push(...p)}else o in r||(r[o]={relations:{},primaryKey:p}),r[o].relations[u]=d}return{tables:n,tableNamesMap:t}}function Ql(i,e){return new $l(i,t=>Object.fromEntries(Object.entries(e(t)).map(([r,n])=>[r,n.withFieldName(r)])))}function lF(i){return function(t,r){return new sr(i,t,r,r?.fields.reduce((n,s)=>n&&s.notNull,!0)??!1)}}function pF(i){return function(t,r){return new uo(i,t,r)}}function MC(i,e,t){if(w(t,sr)&&t.config)return{fields:t.config.fields,references:t.config.references};let r=e[Lr(t.referencedTable)];if(!r)throw new Error(`Table "${t.referencedTable[O.Symbol.Name]}" not found in schema`);let n=i[r];if(!n)throw new Error(`Table "${r}" not found in schema`);let s=t.sourceTable,a=e[Lr(s)];if(!a)throw new Error(`Table "${s[O.Symbol.Name]}" not found in schema`);let o=[];for(let c of Object.values(n.relations))(t.relationName&&t!==c&&c.relationName===t.relationName||!t.relationName&&c.referencedTable===t.sourceTable)&&o.push(c);if(o.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${r}"`):new Error(`There are multiple relations between "${r}" and "${t.sourceTable[O.Symbol.Name]}". Please specify relation name`);if(o[0]&&w(o[0],sr)&&o[0].config)return{fields:o[0].config.references,references:o[0].config.fields};throw new Error(`There is not enough information to infer relation "${a}.${t.fieldName}"`)}function RC(i){return{one:lF(i),many:pF(i)}}function Hl(i,e,t,r,n=s=>s){let s={};for(let[a,o]of r.entries())if(o.isJson){let c=e.relations[o.tsKey],l=t[a],p=typeof l=="string"?JSON.parse(l):l;s[o.tsKey]=w(c,sr)?p&&Hl(i,i[o.relationTableTsKey],p,o.selection,n):p.map(u=>Hl(i,i[o.relationTableTsKey],u,o.selection,n))}else{let c=n(t[a]),l=o.field,p;w(l,re)?p=l:w(l,I)?p=l.decoder:p=l.sql.decoder,s[o.tsKey]=c===null?null:p.mapFromDriverValue(c)}return s}var Ul,$l,sr,uo,fo=S(()=>{bt();pi();A();Qg();Fl();De();Ul=class{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[O.Symbol.Name]}static[v]="Relation";referencedTableName;fieldName},$l=class{constructor(e,t){this.table=e,this.config=t}static[v]="Relations"},sr=class i extends Ul{constructor(e,t,r,n){super(e,t,r?.relationName),this.config=r,this.isNullable=n}static[v]="One";withFieldName(e){let t=new i(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},uo=class i extends Ul{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static[v]="Many";withFieldName(e){let t=new i(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}});var LC=S(()=>{});var DC=S(()=>{});var BC=S(()=>{LC();DC()});var Vl=S(()=>{Fl();BC();De()});var ji,Gl=S(()=>{A();De();ji=class extends ct{static[v]="PgViewBase"}});var ar,Wl=S(()=>{jl();I2();pi();A();Ll();Bl();zr();fo();Vl();De();ui();bt();ue();Ai();Gl();ar=class{static[v]="PgDialect";casing;constructor(e){this.casing=new Ml(e?.casing)}async migrate(e,t,r){let n=typeof r=="string"?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",s=typeof r=="string"?"drizzle":r.migrationsSchema??"drizzle",a=x`
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
error: column "plain_password" does not exist
    at file:///opt/render/project/src/dist/index.js:71:13302
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async file:///opt/render/project/src/dist/index.js:77:37960
    at async Ev.getUserByEmail (file:///opt/render/project/src/dist/index.js:77:114727)
    at async tf._verify (file:///opt/render/project/src/dist/index.js:172:1976) {
  length: 115,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '159',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3822',
  routine: 'errorMissingColumn'
}
Node.js v25.3.0
==> Running 'npm run start'
> rest-express@1.0.0 start
> npm run db:push && node dist/index.js
> rest-express@1.0.0 db:push
> drizzle-kit push
No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/render/project/src/drizzle.config.ts'
Using 'pg' driver for database querying
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[✓] Pulling schema from database...
Is plain_password column in users table created or renamed from another column?
❯ + plain_password                    create column
  ~ kyc_document_url › plain_password rename column[2026-01-15 19:17:32] DEBUG Creating transport: nodemailer (7.0.12; +https://nodemailer.com/; SMTP (pool)/7.0.12[client:7.0.12])
7:17:33 PM [express] serving on port 1000